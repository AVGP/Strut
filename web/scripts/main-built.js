//     Backbone.js 0.9.2
//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

// /** MIT License (c) copyright B Cavalier & J Hann */

// /**
//  * curl css! plugin
//  *
//  * Licensed under the MIT License at:
//  * 		http://www.opensource.org/licenses/mit-license.php
//  *
//  */
// 

//     keymaster.js
//     (c) 2011 Thomas Fuchs
//     keymaster.js may be freely distributed under the MIT license.

/**

JSZip - A Javascript class for generating Zip files
<http://stuartk.com/jszip>

(c) 2009 Stuart Knightley <stuart [at] stuartk.com>
Licenced under the GPLv3 and the MIT licences

Usage:
   zip = new JSZip();
   zip.file("hello.txt", "Hello, World!").add("tempfile", "nothing");
   zip.folder("images").file("smile.gif", base64Data, {base64: true});
   zip.file("Xmas.txt", "Ho ho ho !", {date : new Date("December 25, 2007 00:00:01")});
   zip.remove("tempfile");

   base64zip = zip.generate();

**/

define("vendor/amd/backbone",[],function(){var e={};return e._=window._,e.jQuery=window.jQuery,function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._,o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});var n=this.models;for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t,n),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}.call(e),e.Backbone}),define("vendor/amd/Handlebars",[],function(){var e={};e.VERSION="1.0.beta.6",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(arguments.length===2)return undefined;throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";e.registerHelper("blockHelperMissing",function(e,r){var i=r.inverse||function(){},s=r.fn,o="",u=t.call(e);u===n&&(e=e.call(this));if(e===!0)return s(this);if(e===!1||e==null)return i(this);if(e instanceof Array){if(e.length>0)for(var a=0,f=e.length;a<f;a++)o+=s(e[a]);else o=i(this);return o}return s(e)}),e.registerHelper("each",function(e,t){var n=t.fn,r=t.inverse,i="";if(e&&e.length>0)for(var s=0,o=e.length;s<o;s++)i+=n(e[s]);else i=r(this);return i}),e.registerHelper("if",function(r,i){var s=t.call(r);return s===n&&(r=r.call(this)),!r||e.Utils.isEmpty(r)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){var r=n.fn,i=n.inverse;return n.fn=i,n.inverse=r,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)});var r=function(){var e={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function(t,n,r,i,s,o,u){var a=o.length-1;switch(s){case 1:return o[a-1];case 2:this.$=new i.ProgramNode(o[a-2],o[a]);break;case 3:this.$=new i.ProgramNode(o[a]);break;case 4:this.$=new i.ProgramNode([]);break;case 5:this.$=[o[a]];break;case 6:o[a-1].push(o[a]),this.$=o[a-1];break;case 7:this.$=new i.InverseNode(o[a-2],o[a-1],o[a]);break;case 8:this.$=new i.BlockNode(o[a-2],o[a-1],o[a]);break;case 9:this.$=o[a];break;case 10:this.$=o[a];break;case 11:this.$=new i.ContentNode(o[a]);break;case 12:this.$=new i.CommentNode(o[a]);break;case 13:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 14:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 15:this.$=o[a-1];break;case 16:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1]);break;case 17:this.$=new i.MustacheNode(o[a-1][0],o[a-1][1],!0);break;case 18:this.$=new i.PartialNode(o[a-1]);break;case 19:this.$=new i.PartialNode(o[a-2],o[a-1]);break;case 20:break;case 21:this.$=[[o[a-2]].concat(o[a-1]),o[a]];break;case 22:this.$=[[o[a-1]].concat(o[a]),null];break;case 23:this.$=[[o[a-1]],o[a]];break;case 24:this.$=[[o[a]],null];break;case 25:o[a-1].push(o[a]),this.$=o[a-1];break;case 26:this.$=[o[a]];break;case 27:this.$=o[a];break;case 28:this.$=new i.StringNode(o[a]);break;case 29:this.$=new i.IntegerNode(o[a]);break;case 30:this.$=new i.BooleanNode(o[a]);break;case 31:this.$=new i.HashNode(o[a]);break;case 32:o[a-1].push(o[a]),this.$=o[a-1];break;case 33:this.$=[o[a]];break;case 34:this.$=[o[a-2],o[a]];break;case 35:this.$=[o[a-2],new i.StringNode(o[a])];break;case 36:this.$=[o[a-2],new i.IntegerNode(o[a])];break;case 37:this.$=[o[a-2],new i.BooleanNode(o[a])];break;case 38:this.$=new i.IdNode(o[a]);break;case 39:o[a-2].push(o[a]),this.$=o[a-2];break;case 40:this.$=[o[a]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function(t,n){throw new Error(t)},parse:function(t){function d(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function v(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var m,g,y,b,w,E,S={},x,T,N,C;for(;;){y=r[r.length-1],this.defaultActions[y]?b=this.defaultActions[y]:(m==null&&(m=v()),b=o[y]&&o[y][m]);if(typeof b=="undefined"||!b.length||!b[0])if(!l){C=[];for(x in o[y])this.terminals_[x]&&x>2&&C.push("'"+this.terminals_[x]+"'");var k="";this.lexer.showPosition?k="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+C.join(", ")+", got '"+this.terminals_[m]+"'":k="Parse error on line "+(a+1)+": Unexpected "+(m==1?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:p,expected:C})}if(b[0]instanceof Array&&b.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+m);switch(b[0]){case 1:r.push(m),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(b[1]),m=null,g?(m=g,g=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:T=this.productions_[b[1]][1],S.$=i[i.length-T],S._$={first_line:s[s.length-(T||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(T||1)].first_column,last_column:s[s.length-1].last_column},E=this.performAction.call(S,u,f,a,this.yy,b[1],i,s);if(typeof E!="undefined")return E;T&&(r=r.slice(0,-1*T*2),i=i.slice(0,-1*T),s=s.slice(0,-1*T)),r.push(this.productions_[b[1]][0]),i.push(S.$),s.push(S._$),N=o[r[r.length-2]][r[r.length-1]],r.push(N);break;case 3:return!0}}return!0}},t=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parseError)throw new Error(t);this.yy.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.match+=e,this.matched+=e;var t=e.match(/\n/);return t&&this.yylineno++,this._input=this._input.slice(1),e},unput:function(e){return this._input=e+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r;this._more||(this.yytext="",this.match="");var i=this._currentRules();for(var s=0;s<i.length;s++){t=this._input.match(this.rules[i[s]]);if(t){r=t[0].match(/\n.*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-1:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,i[s],this.conditionStack[this.conditionStack.length-1]);if(e)return e;return}}if(this._input==="")return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.performAction=function(t,n,r,i){var s=i;switch(r){case 0:n.yytext.slice(-1)!=="\\"&&this.begin("mu"),n.yytext.slice(-1)==="\\"&&(n.yytext=n.yytext.substr(0,n.yyleng-1),this.begin("emu"));if(n.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return n.yytext=n.yytext.substr(3,n.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 34;case 13:return 33;case 14:return 33;case 15:return 36;case 16:break;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return n.yytext=n.yytext.substr(1,n.yyleng-2).replace(/\\"/g,'"'),28;case 20:return 30;case 21:return 30;case 22:return 29;case 23:return 33;case 24:return n.yytext=n.yytext.substr(1,n.yyleng-2),33;case 25:return"INVALID";case 26:return 5}},e.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^[^\x00]{2,}?(?=(\{\{))/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[\/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,/^[a-zA-Z0-9_$-]+(?=[=}\s\/.])/,/^\[[^\]]*\]/,/^./,/^$/],e.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,26],inclusive:!0}},e}();return e.lexer=t,e}();return e.Parser=r,e.parse=function(t){return e.Parser.yy=e.AST,e.Parser.parse(t)},e.print=function(t){return(new e.PrintVisitor).accept(t)},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){}},e.log=function(t,n){e.logger.log(t,n)},function(){e.AST={},e.AST.ProgramNode=function(t,n){this.type="program",this.statements=t,n&&(this.inverse=new e.AST.ProgramNode(n))},e.AST.MustacheNode=function(e,t,n){this.type="mustache",this.id=e[0],this.params=e.slice(1),this.hash=t,this.escaped=!n},e.AST.PartialNode=function(e,t){this.type="partial",this.id=e,this.context=t};var t=function(t,n){if(t.original!==n.original)throw new e.Exception(t.original+" doesn't match "+n.original)};e.AST.BlockNode=function(e,n,r){t(e.id,r),this.type="block",this.mustache=e,this.program=n},e.AST.InverseNode=function(e,n,r){t(e.id,r),this.type="inverse",this.mustache=e,this.program=n},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(e){this.type="ID",this.original=e.join(".");var t=[],n=0;for(var r=0,i=e.length;r<i;r++){var s=e[r];s===".."?n++:s==="."||s==="this"?this.isScoped=!0:t.push(s)}this.parts=t,this.string=t.join("."),this.depth=n,this.isSimple=t.length===1&&n===0},e.AST.StringNode=function(e){this.type="STRING",this.string=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.integer=e},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e},e.AST.CommentNode=function(e){this.type="comment",this.comment=e}}(),e.Exception=function(e){var t=Error.prototype.constructor.apply(this,arguments);for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n]);this.message=t.message},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/&(?!\w+;)|[<>"'`]/g,r=/[&<>"'`]/,i=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():t==null||t===!1?"":r.test(t)?t.replace(n,i):t},isEmpty:function(e){return typeof e=="undefined"?!0:e===null?!0:e===!1?!0:e instanceof Array?!0:!1}}}(),e.Compiler=function(){},e.JavaScriptCompiler=function(){},function(t,n){t.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16},t.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1},t.DISASSEMBLE_MAP={};for(var r in t.OPCODE_MAP){var i=t.OPCODE_MAP[r];t.DISASSEMBLE_MAP[i]=r}t.multiParamSize=function(e){return t.MULTI_PARAM_OPCODES[t.DISASSEMBLE_MAP[e]]},t.prototype={compiler:t,disassemble:function(){var e=this.opcodes,n,r,i=[],s,o,u;for(var a=0,f=e.length;a<f;a++){n=e[a];if(n==="DECLARE")o=e[++a],u=e[++a],i.push("DECLARE "+o+" = "+u);else{s=t.DISASSEMBLE_MAP[n];var l=t.multiParamSize(n),c=[];for(var h=0;h<l;h++)r=e[++a],typeof r=="string"&&(r='"'+r.replace("\n","\\n")+'"'),c.push(r);s=s+" "+c.join(" "),i.push(s)}}return i.join("\n")},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t=e.statements,n;this.opcodes=[];for(var r=0,i=t.length;r<i;r++)n=t[r],this[n.type](n);return this.isSimple=i===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var r=0,i=t.depths.list.length;r<i;r++){depth=t.depths.list[r];if(depth<2)continue;this.addDepth(depth-1)}return n},block:function(e){var t=e.mustache,n,r,i,s,o=this.setupStackForMustache(t),u=this.compileProgram(e.program);e.program.inverse&&(s=this.compileProgram(e.program.inverse),this.declare("inverse",s)),this.opcode("invokeProgram",u,o.length,!!t.hash),this.declare("inverse",null),this.opcode("append")},inverse:function(e){var t=this.setupStackForMustache(e.mustache),n=this.compileProgram(e.program);this.declare("inverse",n),this.opcode("invokeProgram",null,t.length,!!e.mustache.hash),this.declare("inverse",null),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("push","{}");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.accept(r),this.opcode("assignToHash",n[0])},partial:function(e){var t=e.id;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.original),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.setupStackForMustache(e);this.opcode("invokeMustache",t.length,e.id.original,!!e.hash),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("lookupWithHelpers",e.parts[0]||null,e.isScoped||!1);for(var t=1,n=e.parts.length;t<n;t++)this.opcode("lookup",e.parts[t])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("push",e.integer)},BOOLEAN:function(e){this.opcode("push",e.bool)},comment:function(){},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.string)):this[n.type](n)},opcode:function(e,n,r,i){this.opcodes.push(t.OPCODE_MAP[e]),n!==undefined&&this.opcodes.push(n),r!==undefined&&this.opcodes.push(r),i!==undefined&&this.opcodes.push(i)},declare:function(e,t){this.opcodes.push("DECLARE"),this.opcodes.push(e),this.opcodes.push(t)},addDepth:function(e){if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},setupStackForMustache:function(e){var t=e.params;return this.pushParams(t),e.hash&&this.hash(e.hash),this.ID(e.id),t}},n.prototype={nameLookup:function(e,t,r){return/^[0-9]+$/.test(t)?e+"["+t+"]":n.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":"buffer += "+e+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,r){this.environment=e,this.options=t||{},this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],aliases:{self:"this"},registers:{list:[]}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.compileChildren(e,t);var i=e.opcodes,s;this.i=0;for(a=i.length;this.i<a;this.i++)s=this.nextOpcode(0),s[0]==="DECLARE"?(this.i=this.i+2,this[s[1]]=s[2]):(this.i=this.i+s[1].length,this[s[0]].apply(this,s[1]));return this.createFunctionContext(r)},nextOpcode:function(e){var n=this.environment.opcodes,r=n[this.i+e],i,s,o,u;if(r==="DECLARE")return i=n[this.i+1],s=n[this.i+2],["DECLARE",i,s];i=t.DISASSEMBLE_MAP[r],o=t.multiParamSize(r),u=[];for(var a=0;a<o;a++)u.push(n[this.i+a+1+e]);return[i,u]},eat:function(e){this.i=this.i+e.length},preamble:function(){var e=[];this.useRegister("foundHelper");if(!this.isChild){var t=this.namespace,n="helpers = helpers || "+t+".helpers;";this.environment.usePartial&&(n=n+" partials = partials || "+t+".partials;"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var n=this.stackVars;this.isChild||(n=n.concat(this.context.registers.list)),n.length>0&&(this.source[1]=this.source[1]+", "+n.join(", "));if(!this.isChild){var r=[];for(var i in this.context.aliases)this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i]}this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");var s=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var o=0,u=this.environment.depths.list.length;o<u;o++)s.push("depth"+this.environment.depths.list[o]);if(t)return s.push(this.source.join("\n  ")),Function.apply(this,s);var a="function "+(this.name||"")+"("+s.join(",")+") {\n  "+this.source.join("\n  ")+"}";return e.log(e.logger.DEBUG,a+"\n\n"),a},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var e=this.nextOpcode(1),t="";this.context.aliases.escapeExpression="this.escapeExpression",e[0]==="appendContent"&&(t=" + "+this.quotedString(e[1][0]),this.eat(e)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+t))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupWithHelpers:function(e,t){if(e){var n=this.nextStack();this.usingKnownHelper=!1;var r;!t&&this.options.knownHelpers[e]?(r=n+" = "+this.nameLookup("helpers",e,"helper"),this.usingKnownHelper=!0):t||this.options.knownHelpersOnly?r=n+" = "+this.nameLookup("depth"+this.lastContext,e,"context"):(this.register("foundHelper",this.nameLookup("helpers",e,"helper")),r=n+" = foundHelper || "+this.nameLookup("depth"+this.lastContext,e,"context")),r+=";",this.source.push(r)}else this.pushStack("depth"+this.lastContext)},lookup:function(e){var t=this.topStack();this.source.push(t+" = ("+t+" === null || "+t+" === undefined || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")+");")},pushStringParam:function(e){this.pushStack("depth"+this.lastContext),this.pushString(e)},pushString:function(e){this.pushStack(this.quotedString(e))},push:function(e){this.pushStack(e)},invokeMustache:function(e,t,n){this.populateParams(e,this.quotedString(t),"{}",null,n,function(e,t,n){this.usingKnownHelper||(this.context.aliases.helperMissing="helpers.helperMissing",this.context.aliases.undef="void 0",this.source.push("else if("+n+"=== undef) { "+e+" = helperMissing.call("+t+"); }"),e!==n&&this.source.push("else { "+e+" = "+n+"; }"))})},invokeProgram:function(e,t,n){var r=this.programExpression(this.inverse),i=this.programExpression(e);this.populateParams(t,null,i,r,n,function(e,t,n){this.usingKnownHelper||(this.context.aliases.blockHelperMissing="helpers.blockHelperMissing",this.source.push("else { "+e+" = blockHelperMissing.call("+t+"); }"))})},populateParams:function(e,t,n,r,i,s){var o=i||this.options.stringParams||r||this.options.data,u=this.popStack(),a,f=[],l,c,h;o?(this.register("tmp1",n),h="tmp1"):h="{ hash: {} }";if(o){var p=i?this.popStack():"{}";this.source.push("tmp1.hash = "+p+";")}this.options.stringParams&&this.source.push("tmp1.contexts = [];");for(var d=0;d<e;d++)l=this.popStack(),f.push(l),this.options.stringParams&&this.source.push("tmp1.contexts.push("+this.popStack()+");");r&&(this.source.push("tmp1.fn = tmp1;"),this.source.push("tmp1.inverse = "+r+";")),this.options.data&&this.source.push("tmp1.data = data;"),f.push(h),this.populateCall(f,u,t||u,s,n!=="{}")},populateCall:function(e,t,n,r,i){var s=["depth0"].concat(e).join(", "),o=["depth0"].concat(n).concat(e).join(", "),u=this.nextStack();if(this.usingKnownHelper)this.source.push(u+" = "+t+".call("+s+");");else{this.context.aliases.functionType='"function"';var a=i?"foundHelper && ":"";this.source.push("if("+a+"typeof "+t+" === functionType) { "+u+" = "+t+".call("+s+"); }")}r.call(this,u,o,t),this.usingKnownHelper=!1},invokePartial:function(e){params=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"],this.options.data&&params.push("data"),this.pushStack("self.invokePartial("+params.join(", ")+");")},assignToHash:function(e){var t=this.popStack(),n=this.topStack();this.source.push(n+"['"+e+"'] = "+t+";")},compiler:n,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler,this.context.programs.push("");var u=this.context.programs.length;r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context)}},programExpression:function(e){if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r=[t.index,t.name,"data"];for(var i=0,s=n.length;i<s;i++)depth=n[i],depth===1?r.push("depth0"):r.push("depth"+(depth-1));return n.length===0?"self.program("+r.join(", ")+")":(r.shift(),"self.programWithDepth("+r.join(", ")+")")},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.context.registers[e]||(this.context.registers[e]=!0,this.context.registers.list.push(e))},pushStack:function(e){return this.source.push(this.nextStack()+" = "+e+";"),"stack"+this.stackSlot},nextStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};var s="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),o=n.RESERVED_WORDS={};for(var u=0,a=s.length;u<a;u++)o[s[u]]=!0;n.isValidJavaScriptVariableName=function(e){return!n.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1}}(e.Compiler,e.JavaScriptCompiler),e.precompile=function(t,n){n=n||{};var r=e.parse(t),i=(new e.Compiler).compile(r,n);return(new e.JavaScriptCompiler).compile(i,n)},e.compile=function(t,n){function i(){var r=e.parse(t),i=(new e.Compiler).compile(r,n),s=(new e.JavaScriptCompiler).compile(i,n,undefined,!0);return e.template(s)}n=n||{};var r;return function(e,t){return r||(r=i()),r.call(this,e,t)}},e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?e.VM.program(n,r):i?i:(i=this.programs[t]=e.VM.program(n),i)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop};return function(r,i){return i=i||{},t.call(n,e,r,i.helpers,i.partials,i.data)}},programWithDepth:function(e,t,n){var r=Array.prototype.slice.call(arguments,2);return function(n,i){return i=i||{},e.apply(this,[n,i.data||t].concat(r))}},program:function(e,t){return function(n,r){return r=r||{},e(n,r.data||t)}},noop:function(){return""},invokePartial:function(t,n,r,i,s,o){options={helpers:i,partials:s,data:o};if(t===undefined)throw new e.Exception("The partial "+n+" could not be found");if(t instanceof Function)return t(r,options);if(!e.compile)throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode");return s[n]=e.compile(t),s[n](r,options)}},e.template=e.VM.template,e}),define("ui/editor/Templates",["vendor/amd/Handlebars"],function(e){return{Component:e.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="content-scale"><div class="content"></div></div><!-- deactivate skewing to discourage bad style <span class="topLabel label skewx" data-delta="skewX">↔</span> --><!-- <span class="leftLabel label skewy" data-delta="skewY">↔</span> --><span class="rightLabel label rotate" data-delta="rotate">↻</span><span class="scale label" data-delta="scale">↔</span><span class="close-btn-red-20 removeBtn" title="Remove"></span><div class="positioningCtrls form-inline">	<span class="label leftposition">→</span>	<input class="position" type="text" data-option="x" value="',u=n.x,u?o=u.call(t,{hash:{}}):(o=t.x,o=typeof o===a?o():o),s+=f(o)+'"/>	<span class="label bottomposition">↑</span>	<input class="position" type="text" data-option="y" value="',u=n.y,u?o=u.call(t,{hash:{}}):(o=t.y,o=typeof o===a?o():o),s+=f(o)+'"/></div>',s}),Editor:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="navbar navbar-fixed-top menuBar">  <div class="btn-inverse temp">    <div class="container">    	<a class="brand" href="#"><img src="res/img/strut-logo-32-light.png" alt="Strut 0.2"/></a>     	<ul class="nav">     		<li class="dropdown active">     			<a href="#" class="dropdown-toggle" data-toggle="dropdown">     				File<b class="caret"></b>     			</a>     			<ul class="dropdown-menu">     		 		<li data-option="new"><a href="#">New</a></li>     				<li data-option="open"><a href="#">Open...</a></li><!--     				<li data-option="openRecent"><a href="#">Open Recent...</a></li> -->     				<li data-option="save"><a href="#">Save</a></li>     				<li data-option="saveAs"><a href="#">Save As...</a></li>     			</ul>     		</li>            <li class="dropdown active">                <a href="#" class="dropdown-toggle" data-toggle="dropdown">                    Edit<b class="caret"></b>                </a>                <ul class="dropdown-menu">                    <li data-option="undo"><a href="#">Undo <span class="undoName label"></span></a></li>                    <li data-option="redo"><a href="#">Redo <span class="redoName label"></span></a></li>                    <li data-option="cut"><a href="#">Cut</a></li>                    <li data-option="copy"><a href="#">Copy</a></li>                    <li data-option="paste"><a href="#">Paste</a></li>                </ul>            </li>            <li class="dropdown active">                <a href="#" class="dropdown-toggle" data-toggle="dropdown">                    Slideshow<b class="caret"></b>                </a>                <ul class="dropdown-menu">                    <li data-option="exportWebpage"><a href="#">Export as Webpage</a></li>                    <li data-option="exportZIP"><a href="#">Zip Presentation</a></li>                    <li class="divider"></li>                    <li data-option="exportJSON"><a href="#">Export to JSON</a></li>                    <li data-option="importJSON"><a href="#">Import from JSON</a></li>                    <li class="divider"></li>                    <li data-option="changeBackground"><a href="#">Change Background</a></li>                </ul>            </li>     	</ul>    </div>  </div></div><div class="perspectives-container"></div><div class="modal hide" id="exportModal">  <div class="modal-header">    <button type="button" class="close" data-dismiss="modal">×</button>    <h3>Export as Webpage</h3>  </div>  <div class="modal-body">    <p>Currently the best way to export your presentation    as a webpage is to use your browser\'s built in "save page" feature.    <ol>        <li>Click <em>Preview</em> to view your presentation</li>        <li>Press <code>Ctrl+S</code> or <code>⌘+s</code></li>        <li>Choose <code>Webpage, Complete</code> for your save as type</li>        <li>Click <code>Save</code></li>    </ol>    </p>  </div>  <div class="modal-footer">    <a href="#" class="btn btn-inverse" data-dismiss="modal">Ok</a>  </div></div><div class="modal hide" id="zipModal">  <div class="modal-header">    <button type="button" class="close" data-dismiss="modal">×</button>    <h3>Export as Webpage</h3>  </div>  <div class="modal-body">    Zip Created!  </div>  <div class="modal-footer">    <p id="downloadify">        You must have Flash 10 installed to download this file.    </p>  </div></div>'}),SlideEditor:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="navbar">  <div class="navbar-inner buttonBar">    <div class="container">        <ul class="nav">            <li style="width: 120px">            	<div class="btn-group iconBtns newSlide">            		<a class="btn btn btn-small menuBarOption" data-option="createSlide" href="#"><i class="icon-plus"></i>Slide</a>            	</div>            </li>            <li class="divider-vertical">            </li>            <li style="width: 120px"></li>           <!-- <li>            	<div class="btn-group normalBtns">            		<a class="btn btn-inverse dropdown-toggle btn-small disabled fontButton fontFamilyBtn" data-toggle="dropdown" title="Choose the font family"><span class="text">Lato</span><span class="caret"></span></a>            		<ul class="dropdown-menu menuBarOption" data-option="fontFamily">            			<li>                                    <a class="lato" href="#" data-value="\'Lato\', sans-serif">Lato</a>                                    <a class="ubuntu" href="#" data-value="\'Ubuntu\', sans-serif">Ubuntu</a>                                    <a class="abril" href="#" data-value="\'Abril Fatface\', cursive">Abril</a>                                    <a class="hammersmith" href="#" data-value="\'Hammersmith One\', sans-serif">Hammersmith One</a>                                    <a class="fredoka" href="#" data-value="\'Fredoka One\', cursive">Fredoka One</a>                                    <a class="gorditas" href="#" data-value="\'Gorditas\', cursive">Gorditas</a>                                    <a class="pressstart" href="#" data-value="\'Press Start 2P\', cursive">Press Start 2P</a>            			</li>            		</ul>            	</div>            </li>            <li>            	<div class="btn-group normalBtns">            		<a class="btn btn-small btn-inverse dropdown-toggle disabled fontButton fontSizeBtn" data-toggle="dropdown" title="Choose the font size"><span class="text">72</span>            			<span class="caret"></span></a>            		<ul class="dropdown-menu menuBarOption" data-option="fontSize">            			<li>                                    <a href="#" data-value="144">144</a>                                    <a href="#" data-value="96">96</a>                                    <a href="#" data-value="72">72</a>            				<a href="#" data-value="64">64</a>                                    <a href="#" data-value="48">48</a>                                    <a href="#" data-value="36">36</a>                                    <a href="#" data-value="24">24</a>                                    <a href="#" data-value="16">16</a>                                    <a href="#" data-value="12">12</a>                                    <a href="#" data-value="8">8</a>            			</li>            		</ul>            	</div>            </li>            <li>                  <div class="color-chooser normalBtns"><div></div></div>            </li>            <li class="divider-vertical">            </li>            <li>                  <div class="btn-group menuBarOption normalBtns">                        <a class="btn btn-small btn-inverse disabled fontButton" data-option="fontWeight" data-value="bold"><strong>B</strong></a>                        <a class="btn btn-small btn-inverse disabled fontButton" data-option="fontStyle" data-value="italic"><em>I</em></a>                  </div>            </li>            <li>                  <div class="btn-group menuBarOption normalBtns">                        <a class="btn btn-small btn-inverse disabled fontButton" data-option="textAlign" data-value="left"><i class="icon-align-left icon-white"></i></a>                        <a class="btn btn-small btn-inverse disabled fontButton" data-option="textAlign" data-value="center"><i class="icon-align-center icon-white"></i></a>                        <a class="btn btn-small btn-inverse disabled fontButton" data-option="textAlign" data-value="right"><i class="icon-align-right icon-white"></i></a>                  </div>            </li>            <li class="divider-vertical">            </li> -->            <li>                  <div class="btn-group iconBtns">                        <a class="btn menuBarOption" data-option="textBox"><i class="icon-text-width"></i>Text</a>                        <a class="btn btn menuBarOption" data-option="picture"><i class="icon-picture"></i>Image</a>                        <!--<a class="btn btn menuBarOption" data-option="iframe"><i class="icon-globe"></i>Website</a>-->                        <a class="btn btn menuBarOption" data-option="video"><i class="icon-facetime-video"></i>Video</a>                        <!-- <a class="btn btn menuBarOption" data-option="table"><i class="icon-th"></i>Table</a>                        <a class="btn btn menuBarOption" data-option="shapes"><i class="icon-star"></i>Shapes</a> -->                  </div>            </li>            <li class="divider-vertical">            </li>        </ul>        <ul class="nav pull-right">            <li>                  <div class="btn-group iconBtns" style="display: inline-block">                        <a class="btn transitionEditorBtn" data-option="transitionEditor"><i class="icon-th-large"></i><span>Overview</span></a>                  </div>                  <div class="btn-group iconBtns" style="display: inline-block">                        <a class="btn btn-success transitionEditorBtn" data-option="preview"><i class="icon-play icon-white"></i><span>Present</span></a>                  </div>            </li>        </ul>    </div>  </div></div><div class="mainContent"></div>'}),SlideSnapshot:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<canvas></canvas><span class="close-btn-red-20 removeBtn" title="Remove"></span><span class="badge badge-inverse"></span>'}),TransitionEditor:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="navbar">  <div class="navbar-inner buttonBar">    <div class="container">      <ul class="nav cameraSettings">        <li>         <!-- <div class="btn-group cameraControls">            <button class="btn"><i class="icon-camera"></i></button>            <a class="btn active" data-option="lookDownZ">Z</a>            <a class="btn" data-option="lookDownY">Y</a>            <a class="btn" data-option="lookDownX">X</a>          </div> -->        </li>        <li class="divider-vertical">        </li>        <li>          <span class="label label-inverse">Interval:</span><input type="text" data-option="interval" value="0"></input>        </li>      </ul>    	<ul class="nav pull-right">    		<li>    			<div class="btn-group iconBtns" style="display: inline-block">                        <a class="btn menuBarOption" data-option="slideEditor"><i class="icon-th-list"></i><span>Slides</span></a>          </div>          <div class="btn-group iconBtns" style="display: inline-block">                        <a class="btn btn-success menuBarOption" data-option="preview"><i class="icon-play icon-white"></i><span>Present</span></a>          </div>    		</li>    	</ul>   	</div>  </div></div><div class="transitionSlides"></div>'}),TransitionSlideSnapshot:e.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="content"><canvas></canvas></div><div class="topLabel form-inline">	<span class="label rotates" data-delta="rotateY">↻Y</span>	<input type="text" data-option="rotateY" value="',u=n.rotateY,u?o=u.call(t,{hash:{}}):(o=t.rotateY,o=typeof o===a?o():o),s+=f(o)+'"></input></div><div class="leftLabel form-inline">	<span class="label rotates" data-delta="rotateX">↻X</span>	<input type="text" data-option="rotateX" value="',u=n.rotateX,u?o=u.call(t,{hash:{}}):(o=t.rotateX,o=typeof o===a?o():o),s+=f(o)+'"></input></div><div class="rightLabel form-inline">	<span class="label rotates" data-delta="rotateZ">↻Z</span>	<input type="text" data-option="rotateZ" value="',u=n.rotateZ,u?o=u.call(t,{hash:{}}):(o=t.rotateZ,o=typeof o===a?o():o),s+=f(o)+'"></input></div><div class="positioningCtrls form-inline">	<span class="label layer">z</span>	<input class="position" type="text" data-option="z" value="',u=n.z,u?o=u.call(t,{hash:{}}):(o=t.z,o=typeof o===a?o():o),s+=f(o)+'"/>	<span class="label scales">↔</span>	<input class="position" type="text" data-option="scale" value="',u=n.impScale,u?o=u.call(t,{hash:{}}):(o=t.impScale,o=typeof o===a?o():o),s+=f(o)+'"/></div><span class="badge badge-inverse"></span>',s})}}),define("css",[],function(){function e(e){if(typeof document=="undefined")return;var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href="scripts/"+e,document.getElementsByTagName("head")[0].appendChild(t)}return{load:function(t,n,r,i){e(t),r(null)}}}),define("common/Queue",[],function(){function e(){this._queue=[]}function t(){return new e}return e.prototype={take:function(){return this._queue.length!=0?this._queue.shift():null},enqueue:function(e){this._queue.push(e)}},{create:t}}),define("common/Throttler",["common/Queue"],function(e){function t(t,n){this._handle=null,this._delay=t,this._queue=e.create(),this._context=n}return t.prototype={submit:function(e,t){this._handle?t&&this._handleFailedSubmit(e,t):this._internalSubmit(e,t)},_internalSubmit:function(e,t){var n=this;this._handle=setTimeout(function(){t&&t.arguments?e.apply(n._context,t.arguments):e.call(n._context),n._internalCB()},this._delay)},_internalCB:function(){var e=this._queue.take();if(e)this._handle=this._internalSubmit(e);else if(this._runLast){var t=this._runLast;this._runLast=null,this._handle=this._internalSubmit(t)}else this._handle=null},_handleFailedSubmit:function(e,t){switch(t.rejectionPolicy){case"queue":this._queue.enqueue(e);break;case"runLast":this._runLast=e;break;case"drop":}}},t}),define("ui/editor/raster/AbstractDrawer",[],function(){var e;return e=function(){function e(){}return e.prototype.applyTransforms=function(e,t){var n,r,i,s,o;n=e.get("rotate"),r=e.get("scale"),this.g2d.translate(t.x,t.y),r!=null&&this.g2d.scale(r.x,r.y),this.g2d.translate(t.width/2,t.height/2),n!=null&&this.g2d.rotate(n),i=e.get("skewX"),s=e.get("skewY");if(i||s)o=[1,0,0,1,0,0],i&&(o[2]=i),s&&(o[1]=s),this.g2d.transform.apply(this.g2d,o);return this.g2d.translate(-1*(t.width/2+t.x),-1*(t.height/2+t.y))},e}()});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("ui/editor/raster/TextboxDrawer",["./AbstractDrawer"],function(e){var t,n,r;return n=/<[^>]+>|<\/[^>]+>/,r=/&nbsp;/g,t=function(e){function t(e){this.g2d=e}return __extends(t,e),t.prototype.paint=function(e){var t,n,r,i,s,o,u=this;return this.g2d.fillStyle="#"+e.get("color"),r=e.get("size")*this.scale.y,this.g2d.font=r+"px "+e.get("family"),s=this._convertSpaces(e.get("text")),i=this._extractLines(s),o=this._findWidestWidth(i)*this.scale.x,t={x:e.get("x")*this.scale.x,y:e.get("y")*this.scale.y,width:o+o,height:e.get("size")*this.scale.y},this.applyTransforms(e,t),n=0,i.forEach(function(e){if(e!=="")return u.g2d.fillText(e,t.x,t.y+t.height+n*r),++n})},t.prototype._extractLines=function(e){return e.split(n)},t.prototype._convertSpaces=function(e){return e.replace(r," ")},t.prototype._findWidestWidth=function(e){var t,n=this;return t=0,e.forEach(function(e){var r;r=n.g2d.measureText(e).width;if(r>t)return t=r}),t},t}(e)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define("ui/editor/raster/ImageModelDrawer",["./AbstractDrawer"],function(e){var t;return t=function(e){function t(e){this.g2d=e}return __extends(t,e),t.prototype.paint=function(e){return this._imageLoaded(e.cachedImage,e)},t.prototype._imageLoaded=function(e,t){var n;return n={x:t.get("x")*this.scale.x,y:t.get("y")*this.scale.y,width:e.naturalWidth*this.scale.x,height:e.naturalHeight*this.scale.y},this.applyTransforms(t,n),this.g2d.drawImage(e,n.x,n.y,n.width,n.height)},t}(e)}),define("ui/editor/raster/SlideDrawer",["common/Throttler","./TextboxDrawer","./ImageModelDrawer"],function(e,t,n){var r;return r=function(){function r(r,i){var s,o,u;this.model=r,this.g2d=i,this.model.on("contentsChanged",this.repaint,this),this.size={width:this.g2d.canvas.width,height:this.g2d.canvas.height},this.throttler=new e(600,this),this.scale={x:this.size.width/slideConfig.size.width,y:this.size.height/slideConfig.size.height},this.drawers={TextBox:new t(this.g2d),ImageModel:new n(this.g2d)},u=this.drawers;for(s in u)o=u[s],o.scale=this.scale}return r.prototype.resized=function(e){var t,n,r;this.size=e,this.scale=this.size.width/slideConfig.size.width,r=this.drawers;for(t in r)n=r[t],n.scale=this.scale;return this.repaint()},r.prototype.repaint=function(){return this.throttler.submit(this.paint,{rejectionPolicy:"runLast"})},r.prototype.paint=function(){var e,t=this;return this.g2d.clearRect(0,0,this.size.width,this.size.height),e=this.model.get("components"),e.forEach(function(e){var n,r;r=e.get("type"),n=t.drawers[r];if(n!=null)return t.g2d.save(),n.paint(e),t.g2d.restore()})},r.prototype.dispose=function(){return this.model.off(null,null,this)},r}()}),define("ui/editor/SlideSnapshot",["vendor/amd/backbone","./Templates","css!./res/css/SlideSnapshot.css","./raster/SlideDrawer"],function(e,t,n,r){return e.View.extend({className:"slideSnapshot",events:{click:"clicked","click .removeBtn":"removeClicked"},initialize:function(){return this.model.on("change:active",this._activated,this),this.model.on("dispose",this._modelDisposed,this),this.options.deck.on("change:background",this._updateBG,this)},clicked:function(){return this.model.set("selected",!0),this.model.set("active",!0)},removeClicked:function(e){return this.trigger("removeClicked",this),e.stopPropagation()},remove:function(){return this.slideDrawer.dispose(),this.off(),this.$el.data("jsView",null),this.model.off(null,null,this),this.options.deck.off(null,null,this),e.View.prototype.remove.apply(this,arguments)},_activated:function(e,t){return t?this.$el.addClass("active"):this.$el.removeClass("active")},_modelDisposed:function(){return this.model.off(null,null,this),this.remove()},_updateBG:function(){var e;e=this.options.deck.get("background"),console.log("BG UPDATED");if(e!=null)return this.$el.css("background-image",e.styles[0]),this.$el.css("background-image",e.styles[1])},render:function(){var e,n=this;return this.slideDrawer!=null&&this.slideDrawer.dispose(),this.$el.html(t.SlideSnapshot(this.model.attributes)),e=this.$el.find("canvas")[0].getContext("2d"),this.slideDrawer=new r(this.model,e),setTimeout(function(){return n.slideDrawer.repaint()},0),this.model.get("active")&&this.$el.addClass("active"),this.$el.data("jsView",this),this._updateBG(),this.$el}})}),define("vendor/amd/keymaster",[],function(){var e={};return function(e){function u(e,t){var n=e.length;while(n--)if(e[n]===t)return n;return-1}function a(e){var t,o,a,f,l;t=e.keyCode;if(t==93||t==224)t=91;if(t in r){r[t]=!0;for(a in s)s[a]==t&&(c[a]=!0);return}if(!c.filter.call(this,e))return;if(!(t in n))return;for(f=0;f<n[t].length;f++){o=n[t][f];if(o.scope==i||o.scope=="all"){l=o.mods.length>0;for(a in r)if(!r[a]&&u(o.mods,+a)>-1||r[a]&&u(o.mods,+a)==-1)l=!1;(o.mods.length==0&&!r[16]&&!r[18]&&!r[17]&&!r[91]||l)&&o.method(e,o)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}}function f(e){var t=e.keyCode,n;if(t==93||t==224)t=91;if(t in r){r[t]=!1;for(n in s)s[n]==t&&(c[n]=!1)}}function l(){for(t in r)r[t]=!1;for(t in s)c[t]=!1}function c(e,t,r){var i,u,a,f;r===undefined&&(r=t,t="all"),e=e.replace(/\s/g,""),i=e.split(","),i[i.length-1]==""&&(i[i.length-2]+=",");for(a=0;a<i.length;a++){u=[],e=i[a].split("+");if(e.length>1){u=e.slice(0,e.length-1);for(f=0;f<u.length;f++)u[f]=s[u[f]];e=[e[e.length-1]]}e=e[0],e=o[e]||e.toUpperCase().charCodeAt(0),e in n||(n[e]=[]),n[e].push({shortcut:i[a],scope:t,method:r,key:i[a],mods:u})}}function h(e){var t=(e.target||e.srcElement).tagName;return t!="INPUT"&&t!="SELECT"&&t!="TEXTAREA"}function p(e){i=e||"all"}function d(){return i||"all"}function v(e){var t,r,i;for(t in n){r=n[t];for(i=0;i<r.length;)r[i].scope===e?r.splice(i,1):i++}}function m(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,function(){n(window.event)})}var t,n={},r={16:!1,18:!1,17:!1,91:!1},i="all",s={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},o={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220};for(t=1;t<20;t++)s["f"+t]=111+t;for(t in s)c[t]=!1;m(document,"keydown",a),m(document,"keyup",f),m(window,"focus",l),e.key=c,e.key.setScope=p,e.key.getScope=d,e.key.deleteScope=v,e.key.filter=h,typeof module!="undefined"&&(module.exports=key)}(e),e.key}),define("ui/interactions/CutCopyPasteBindings",["vendor/amd/keymaster"],function(e){var t,n;return t=["cut","copy","paste"],n={applyTo:function(n,r){return _.bindAll(n,t),e("ctrl+x, ⌘+x",r,n.cut),e("ctrl+c, ⌘+c",r,n.copy),e("ctrl+v, ⌘+v",r,n.paste)}}}),define("model/system/Clipboard",["vendor/amd/backbone"],function(e){return e.Model.extend()}),define("ui/editor/SlideCopyPaste",[],function(){var e;return e={cut:function(){var e;e=this.model.get("activeSlide");if(e!=null)return this._clipboard.set("item",e),this.model.removeSlide(e),e.set("selected",!1),!1},copy:function(){var e;e=this.model.get("activeSlide");if(e!=null)return this._clipboard.set("item",e.clone()),!1},paste:function(){var e,t;e=this._clipboard.get("item");if(e!=null)return t=e.clone(),t.set("x",null),t.set("y",null),this.model.addSlide(t)}}}),define("ui/editor/SlidePreviewPanel",["vendor/amd/backbone","./SlideSnapshot","vendor/amd/keymaster","ui/interactions/CutCopyPasteBindings","model/system/Clipboard","./SlideCopyPaste","css!./res/css/SlidePreviewPanel.css"],function(e,t,n,r,i,s,o){return e.View.extend({className:"slidePreviewPanel",events:{sortstop:"sortstop",click:"clicked"},initialize:function(){var e;return e=this.model.get("slides"),e.on("add",this._slideCreated,this),e.on("reset",this._slidesReset,this),_.extend(this,s),r.applyTo(this,"slidePreviewPanel"),this._clipboard=new i},_slideCreated:function(e,n,r){var i,s;return s=new t({model:e,deck:this.model}),s.on("removeClicked",this.slideRemoveClicked,this),r!=null?(i=this.$el.children(),i.length>0&&r.index<i.length?i.eq(r.index).before(s.render()):this.$el.append(s.render())):this.$el.append(s.render())},_slidesReset:function(e){var t=this;return e.each(function(e){return t._slideCreated(e)})},_slideRemoved:function(e,t,n){return this.snapshots[n.index].remove(),this.snapshots.splice(n.index,1)},slideRemoveClicked:function(e){return this.model.removeSlide(e.model)},render:function(){var e,t=this;return e=this.model.get("slides"),e!=null&&e.each(function(e){return t._slideCreated(e)}),this.$el.sortable(),this.$el},sortstop:function(e,t){var n=this;return this.$el.children().each(function(e,t){return $(t).data("jsView").model.set("num",e)}),this.model.get("slides").sort({silent:!0})},clicked:function(){if(n.getScope()!=="slidePreviewPanel")return n.setScope("slidePreviewPanel")},remove:function(){return e.View.prototype.remove.apply(this,arguments),this.dispose()},dispose:function(){return this.snapshots.forEach(function(e){return e.dispose()})}})}),define("ui/widgets/DeltaDragControl",[],function(){var e,t;return t=["mousedown","mousemove","mouseup"],e=function(){function e(e,t){this.$el=e,this.stopProp=t,this.dragging=!1,this._mousemove=this.mousemove.bind(this),this._mouseup=this.mouseup.bind(this),this._mouseout=this._mouseup,$(document).bind("mousemove",this._mousemove),$(document).bind("mouseup",this._mouseup),this.$el.bind("mousedown",this.mousedown.bind(this)),this.$el.bind("mouseup",this._mouseup)}return e.prototype.dispose=function(){return $(document).unbind("mousemove",this._mousemove),$(document).unbind("mouseup",this._mouseup)},e.prototype.mousedown=function(e){this.dragging=!0,this._startPos={x:e.pageX,y:e.pageY},this.$el.trigger("deltadragStart",{x:e.pageX,y:e.pageY});if(this.stopProp)return e.stopPropagation()},e.prototype.mousemove=function(e){var t,n;if(this.dragging){t=e.pageX-this._startPos.x,n=e.pageY-this._startPos.y,this.$el.trigger("deltadrag",[{dx:t,dy:n,x:e.pageX,y:e.pageY}]);if(this.stopProp)return e.stopPropagation()}},e.prototype.mouseup=function(e){return this.dragging=!1,this.$el.trigger("deltadragStop"),!0},e}()}),define("common/Math2",{round:function(e,t){var n;return t!=null||(t=0),n=Math.pow(10,t),Math.round(e*n)/n},toDeg:function(e){return e*180/Math.PI},toRads:function(e){return e*Math.PI/180},compare:function(e,t,n){return Math.abs(e-t)<n},rotatePt:function(e,t){var n;return t<0?n={x:e.x*Math.cos(t)+e.y*Math.sin(t),y:-1*e.x*Math.sin(t)+e.y*Math.cos(t)}:n={x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}},rotatePtE:function(e,t){var n;return t<0?n={left:e.left*Math.cos(t)+e.top*Math.sin(t),top:-1*e.left*Math.sin(t)+e.top*Math.cos(t)}:n={left:e.left*Math.cos(t)-e.top*Math.sin(t),top:e.left*Math.sin(t)+e.top*Math.cos(t)}}}),define("common/Calcium",["vendor/amd/backbone"],function(e){function t(t){return t instanceof e.Model||t instanceof e.Collection}function i(e,t,n){this.args=n,this.obj=e,this.fn=t}var n=e.Model.extend({toJSON:function(n,r){if(n)return e.Model.prototype.toJSON.apply(this,arguments);var i={};for(var s in this.attributes){var o=this.attributes[s];if(t(o))i[s]=o.toJSON(n,r);else if(r&&o instanceof Array){var u=[];i[s]=u,o.forEach(function(e,i){t(e)?u.push(e.toJSON(n,r)):u.push(e)})}else i[s]=o}return i}}),r=e.Collection.extend({toJSON:function(t,n){if(t)return e.Collection.prototype.toJSON.apply(this,arguments);var r=[];return this.models.forEach(function(e,i){r.push(e.toJSON(t,n))}),r}});return i.prototype={dispose:function(){this.fn.apply(this.obj,this.args)}},{Model:n,Collection:r}}),define("model/geom/SpatialObject",["common/Calcium","common/Math2"],function(e,t){return e.Model.extend({initialize:function(){},setInt:function(e,t){if(typeof t=="string")try{t=parseInt(t)}catch(n){return}return this.set(e,Math.round(t))},setFloat:function(e,n,r){if(typeof n=="string")try{n=parseInt(n)}catch(i){return}return r||(r=2),n=t.round(n,r),this.set(e,n)},constructor:function(){e.Model.prototype.constructor.apply(this,arguments)}})}),define("model/presentation/components/Component",["model/geom/SpatialObject"],function(e){var t,n;return n={x:window.slideConfig.size.width/3,y:window.slideConfig.size.height/3},t={x:1,y:1},e.extend({initialize:function(){_.defaults(this.attributes,n);if(this.attributes.scale==null)return this.attributes.scale={},_.defaults(this.attributes.scale,t)},dispose:function(){return this.trigger("dispose",this),this.off()},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("common/FileUtils",[],function(){var e;return e={baseName:function(e,t){var n;return e[e.length-1]==="/"&&(e=e.substring(0,e.length-1)),n=e.lastIndexOf("/"),n!==-1&&n+1<e.length&&(e=e.substring(n+1,e.length)),t!=null&&(n=e.lastIndexOf(t),n+t.length===e.length&&(e=e.substring(0,n))),e},imageType:function(t){var n;return t.indexOf("data:")===0?(n=t.indexOf(";"),t.substring(11,n).toUpperCase()):e.extension(t)},extension:function(e){var t,n;return n=e.lastIndexOf("."),n!==-1&&n+1<e.length?(t=e.substring(n+1,e.length),n=t.lastIndexOf("?"),n!==-1&&(t=t.substring(0,n)),t.toUpperCase()):""},type:function(e){switch(e){case"MP4":return"video/mp4";case"WEBM":return"video/webm";case"OGG":return"video/ogg";default:return""}}}}),define("model/presentation/components/Image",["./Component","common/FileUtils"],function(e,t){return e.extend({initialize:function(){var n;return e.prototype.initialize.apply(this,arguments),this.set("type","ImageModel"),n=this.get("src"),this.set("imageType",t.imageType(n)),this.on("change:src",this._updateCache,this),this.cachedImage=new Image,this._updateCache()},_updateCache:function(){return this.cachedImage.src=this.get("src")},toBase64:function(){},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("model/presentation/components/Table",function(){}),define("model/presentation/components/TextBox",["./Component"],function(e){return e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments),this.set("type","TextBox");if(this.get("text")==null)return this.set("text","Text")},textWithBreaks:function(){},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("model/presentation/components/WebFrame",["./Component","common/FileUtils"],function(e,t){return e.extend({initialize:function(){return e.prototype.initialize.apply(this,arguments),this.set("type","WebFrame")},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("model/presentation/components/Video",["./Component","common/FileUtils"],function(e,t){return e.extend({initialize:function(){var n;return e.prototype.initialize.apply(this,arguments),this.set("type","Video"),n=t.type(t.extension(this.get("src"))),this.set("videoType",n)},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("model/presentation/components/ComponentFactory",["./Image","./Table","./TextBox","./WebFrame","./Video"],function(e,t,n,r,i){var s;return s={createTextBox:function(e){return new n(e)},createImage:function(t){return new e(t)},createWebFrame:function(e){return new r(e)},createVideo:function(e){return new i(e)},create:function(t){switch(t.type){case"ImageModel":return new e(t);case"TextBox":return new n(t);case"Video":return new i(t)}}}}),define("model/commands/ComponentCommands",[],function(){var e,t,n;return e=function(e,t){this.slide=e,this.component=t},e.prototype={"do":function(){return this.slide.__doAdd(this.component)},undo:function(){return this.slide.__doRemove(this.component)},name:"Add Comp"},t=function(e,t){this.slide=e,this.component=t},t.prototype={"do":function(){return this.slide.__doRemove(this.component)},undo:function(){return this.slide.__doAdd(this.component)},name:"Remove Comp"},n={Add:e,Remove:t}}),define("model/presentation/Slide",["vendor/amd/backbone","model/geom/SpatialObject","./components/ComponentFactory","common/Math2","model/commands/ComponentCommands"],function(e,t,n,r,i){var s;return s={z:0,impScale:1,rotateX:0,rotateY:0,rotateZ:0},t.extend({initialize:function(){var t,r,i=this;return t=this.get("components"),t==null?this.set("components",[]):(r=[],this.set("components",r),t.forEach(function(t){var s;return t instanceof e.Model?(s=t.clone(),r.push(s)):(s=n.create(t),r.push(s)),i._registerWithComponent(s)})),_.defaults(this.attributes,s),this.on("unrender",this._unrendered,this)},_unrendered:function(){return this.get("components").forEach(function(e){return e.trigger("unrender",!0)})},_registerWithComponent:function(e){return e.on("dispose",this.remove,this),e.on("change:selected",this.selectionChanged,this),e.on("change",this.componentChanged,this)},getPositionData:function(){return{x:this.attributes.x,y:this.attributes.y,z:this.attributes.z,impScale:this.attributes.impScale,rotateX:this.attributes.rotateX,rotateY:this.attributes.rotateY,rotateZ:this.attributes.rotateZ}},add:function(e){var t;return this._placeComponent(e),t=new i.Add(this,e),t["do"](),window.undoHistory.push(t)},__doAdd:function(e){return this.attributes.components.push(e),this._registerWithComponent(e),this.trigger("contentsChanged"),this.trigger("change:components.add",this,e)},_placeComponent:function(e){return this.attributes.components.forEach(function(t){var n,i;n=t.get("x"),i=t.get("y");if(r.compare(n,e.get("x"),5)&&r.compare(i,e.get("y"),5))return e.set({x:n+20,y:i+20})})},dispose:function(){return this.set({active:!1,selected:!1}),this.trigger("dispose",this),this.off("dispose")},remove:function(e){var t;return t=new i.Remove(this,e),t["do"](),window.undoHistory.push(t)},__doRemove:function(e){var t;return t=this.attributes.components.indexOf(e),t!==-1?(this.attributes.components.splice(t,1),this.trigger("contentsChanged"),this.trigger("change:components.remove",this,e),e.trigger("unrender"),e.off(null,null,this),e):null},componentChanged:function(e,t){return this.trigger("contentsChanged")},unselectComponents:function(){if(this.lastSelection)return this.lastSelection.set("selected",!1)},selectionChanged:function(e,t){return t?(this.lastSelection!==e&&(this.attributes.components.forEach(function(t){if(t!==e)return t.set("selected",!1)}),this.lastSelection=e),this.trigger("change:activeComponent",this,e,t)):(this.trigger("change:activeComponent",this,null),this.lastSelection=null)},constructor:function(){t.prototype.constructor.apply(this,arguments)}})}),define("model/commands/SlideCommands",["model/presentation/Slide"],function(e){var t,n,r,i;return t=function(e){return this.deck=e,this},t.prototype={"do":function(){var t;return t=this.deck.get("slides"),this.slide==null&&(this.slide=new e({num:t.length})),t.add(this.slide),this.slide},undo:function(){return this.deck.get("slides").remove(this.slide),this.slide},name:"Create Slide"},r=function(e,t){return this.deck=e,this.slide=t,this},r.prototype={"do":function(){var e;return e=this.deck.get("slides"),this._idx=e.indexOf(this.slide),e.remove(this.slide),this.slide.off(),this.slide},undo:function(){return this.deck.get("slides").add(this.slide,{at:this._idx})},name:"Remove Slide"},n=function(e,t){return this.startLoc=e,this.model=t,this.endLoc={x:this.model.get("x"),y:this.model.get("y")},this},n.prototype={"do":function(){return this.model.set(this.endLoc)},undo:function(){return this.model.set(this.startLoc)},name:"Move"},i={Create:t,Remove:r,Move:n}}),define("ui/editor/components/ComponentView",["vendor/amd/backbone","ui/widgets/DeltaDragControl","../Templates","common/Math2","css!../res/css/ComponentView.css","vendor/amd/keymaster","model/commands/SlideCommands"],function(e,t,n,r,i,s,o){return e.View.extend({transforms:["skewX","skewY"],className:"component",events:function(){return{mousedown:"mousedown",click:"clicked","click .removeBtn":"removeClicked","change input[data-option='x']":"manualMoveX","change input[data-option='y']":"manualMoveY","deltadrag span[data-delta='skewX']":"skewX","deltadrag span[data-delta='skewY']":"skewY","deltadrag span[data-delta='rotate']":"rotate","deltadrag span[data-delta='scale']":"scale","deltadragStart span[data-delta='skewX']":"skewXStart","deltadragStart span[data-delta='skewY']":"skewYStart","deltadragStart span[data-delta='rotate']":"rotateStart","deltadragStart span[data-delta='scale']":"scaleStart"}},initialize:function(){return this._dragging=!1,this.allowDragging=!0,this.model.on("change:selected",this.__selectionChanged,this),this.model.on("change:color",this._colorChanged,this),this.model.on("unrender",this._unrender,this),this._mouseup=this.stopdrag.bind(this),this._mousemove=this.mousemove.bind(this),$(document).bind("mouseup",this._mouseup),$(document).bind("mousemove",this._mousemove),this._deltaDrags=[],this.model.on("rerender",this._setUpdatedTransform,this),this.model.on("change:x",this._xChanged,this),this.model.on("change:y",this._yChanged,this),this._lastDeltas={dx:0,dy:0}},__selectionChanged:function(e,t){return t?this.$el.addClass("selected"):this.$el.removeClass("selected")},_colorChanged:function(e,t){return this.$el.css("color","#"+t)},_xChanged:function(e,t){return this.$el.css("left",t),this.$xInput.val(t)},_yChanged:function(e,t){return this.$el.css("top",t),this.$yInput.val(t)},clicked:function(e){return this.$el.trigger("focused"),e.stopPropagation(),!1},removeClicked:function(e){return e.stopPropagation(),this.remove()},skewX:function(e,t){return this.model.setFloat("skewX",this._initialSkewX+Math.atan2(t.dx,22)),this._setUpdatedTransform()},skewXStart:function(){return this._initialSkewX=this.model.get("skewX")||0},skewY:function(e,t){return this.model.setFloat("skewY",this._initialSkewY+Math.atan2(t.dy,22)),this._setUpdatedTransform()},skewYStart:function(){return this._initialSkewY=this.model.get("skewY")||0},manualMoveX:function(e){return this.model.setInt("x",e.target.value)},manualMoveY:function(e){return this.model.setInt("y",e.target.value)},rotate:function(e,t){var n,r;return r=this._calcRot(t),n=this._initialRotate+r-this._rotOffset,s.shift&&(n=Math.floor(n/Math.PI*8)/8*Math.PI),this.model.setFloat("rotate",n),this._setUpdatedTransform()},rotateStart:function(e,t){return this.updateOrigin(),this._rotOffset=this._calcRot(t),this._initialRotate=this.model.get("rotate")||0},updateOrigin:function(){var e;return e=this.$el.offset(),this._origin={x:this.$el.width()/2+e.left,y:this.$el.height()/2+e.top}},_calcRot:function(e){return Math.atan2(e.y-this._origin.y,e.x-this._origin.x)},scaleStart:function(e,t){var n,r,i,s,o;this.dragScale=this.$el.parent().css(window.browserPrefix+"transform"),this.dragScale=parseFloat(this.dragScale.substring(7,this.dragScale.indexOf(",")))||1,this._initialScale=this.model.get("scale"),i=this.$el.offset(),s=this.$el.width()*this._initialScale.x,r=this.$el.height()*this._initialScale.y,n=Math.sqrt(s/2*(s/2)+r/2*(r/2)),o=this.model.get("rotate")||0,o+=Math.atan2(r/2,s/2),this._scaleCenter={x:i.left+Math.abs(Math.cos(o)),y:i.top+Math.abs(Math.sin(o))},this._scaleDeltas={x:Math.abs(t.x-this._scaleCenter.x)/this.dragScale,y:Math.abs(t.y-this._scaleCenter.y)/this.dragScale};if(this.origSize==null)return this.origSize={width:this.$el.width(),height:this.$el.height()}},scale:function(e,t){var n,r,i,o;return i=s.shift,n=Math.abs(t.x-this._scaleCenter.x)/this.dragScale,r=Math.abs(t.y-this._scaleCenter.y)/this.dragScale,o={x:this._initialScale.x*(n/this._scaleDeltas.x),y:this._initialScale.y*(i?r/this._scaleDeltas.y:n/this._scaleDeltas.x)},o.width=o.x*this.origSize.width,o.height=o.y*this.origSize.height,this.model.set("scale",o),this._setUpdatedTransform()},_setUpdatedTransform:function(){var e,t,n,r,i;return i=this.buildTransformString(),n={transform:i},n[window.browserPrefix+"transform"]=i,this.$content.css(n),r=this.model.get("scale"),this.origSize!=null&&(t=r.width||this.origSize.width,e=r.height||this.origSize.height,this.$el.css({width:t,height:e})),r!=null&&this.$contentScale.css(window.browserPrefix+"transform","scale("+r.x+","+r.y+")"),this.$el.css(window.browserPrefix+"transform","rotate("+this.model.get("rotate")+"rad)")},buildTransformString:function(){var e,t=this;return e="",this.transforms.forEach(function(n){var r;r=t.model.get(n);if(r)return e+=n+"("+r+"rad) "}),e},mousedown:function(e){if(e.which===1)return this.model.set("selected",!0),this.$el.css("zIndex",zTracker.next()),this.dragScale=this.$el.parent().css(window.browserPrefix+"transform"),this.dragScale=parseFloat(this.dragScale.substring(7,this.dragScale.indexOf(",")))||1,this._dragging=!0,this._prevPos={x:this.model.get("x"),y:this.model.get("y")},this._prevMousePos={x:e.pageX,y:e.pageY}},render:function(){var e,n=this;return this.$el.html(this.__getTemplate()(this.model.attributes)),this.$el.find("span[data-delta]").each(function(e,r){var i;return i=new t($(r),!0),n._deltaDrags.push(i)}),this.$content=this.$el.find(".content"),this.$contentScale=this.$el.find(".content-scale"),this.__selectionChanged(this.model,this.model.get("selected")),this.$xInput=this.$el.find("[data-option='x']"),this.$yInput=this.$el.find("[data-option='y']"),this.$el.css({top:this.model.get("y"),left:this.model.get("x")}),e={width:this.$el.width(),height:this.$el.height()},e.width>0&&e.height>0&&(this.origSize=e),this._setUpdatedTransform(),this.$el},__getTemplate:function(){return n.Component},_unrender:function(){return this.remove(!0)},remove:function(t){var n,r,i,s;e.View.prototype.remove.call(this),s=this._deltaDrags;for(i in s)r=s[i],r.dispose();return t?this.model.off(null,null,this):(this.model.dispose(),this.model.off(null,null,this)),n=$(document),n.unbind("mouseup",this._mouseup),n.unbind("mousemove",this._mousemove)},mousemove:function(e){var t,n,r,i,o,u;if(this._dragging&&this.allowDragging){u=s.shift,t=e.pageX-this._prevMousePos.x,n=e.pageY-this._prevMousePos.y,i=this._prevPos.x+t/this.dragScale,o=this._prevPos.y+n/this.dragScale,u&&(r=20,i=Math.floor(i/r)*r,o=Math.floor(o/r)*r),this.model.setInt("x",i),this.model.setInt("y",o);if(this.dragStartLoc==null)return this.dragStartLoc={x:i,y:o}}},stopdrag:function(){var e;return this._dragging&&(this._dragging=!1,this.dragStartLoc!=null&&this.dragStartLoc.x!==this.model.get("x")&&this.dragStartLoc.y!==this.model.get("y")&&(e=new o.Move(this.dragStartLoc,this.model),window.undoHistory.push(e)),this.dragStartLoc=void 0),!0},constructor:function(){e.View.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/components/ImageView",["./ComponentView"],function(e){var t;return t=function(e,t){var n,r,i;return r=this.$el.offset(),i=(t.x-r.left)/this.dragScale,n=(t.y-r.top)/this.dragScale,this.$el.css({width:i,height:n}),this.model.set("scale",{width:i,height:n})},e.extend({className:"component imageView",tagName:"div",initialize:function(){e.prototype.initialize.apply(this,arguments);if(this.model.get("imageType")==="SVG")return this.scale=t},_finishRender:function(e){var t,n,r,i,s;r=e[0].naturalWidth,n=e[0].naturalHeight,this.model.get("imageType")==="SVG"?(e.css({width:"100%",height:"100%"}),i=this.model.get("scale"),i&&i.width?this.$el.css({width:i.width,height:i.height}):(s=Math.max(r,50),t=Math.max(n,50),this.$el.css({width:s,height:t}),this.model.set("scale",{width:s,height:t}))):(this.origSize={width:r,height:n},e[0].width=r,e[0].height=n,this._setUpdatedTransform()),e.bind("dragstart",function(e){return e.preventDefault(),!1}),this.$content.append(e);if(this.model.get("imageType")==="SVG")return e.parent().addClass("svg"),e.parent().parent().addClass("svg")},render:function(){var t,n=this;return e.prototype.render.call(this),t=$("<img src="+this.model.get("src")+"></img>"),t.load(function(){return n._finishRender(t)}),t.error(function(){return n.remove()}),this.$el}})}),define("ui/editor/components/TableView",function(){}),define("vendor/amd/etch",["vendor/amd/backbone"],function(e){function s(e){var t=e.target.dataset.value;return t==null&&($target=$(e.target),t=$target.parent()[0].dataset.value),t}var t={},n={},r={},i={};return i.VERSION="0.6.2",i.config={selector:".editable",buttonClasses:{"default":["save"],all:["bold","italic","underline","unordered-list","ordered-list","link","clear-formatting","save"],title:["bold","italic","underline","save"]}},t.Editor=e.Model,n.Editor=e.View.extend({initialize:function(){this.$el=$(this.el),_.bindAll(this,"changeButtons","changePosition","changeEditable","insertImage","_editableModelChanged"),this.model.bind("change:buttons",this.changeButtons),this.model.bind("change:position",this.changePosition),this.model.bind("change:editable",this.changeEditable),this.model.on("change:editableModel",this._editableModelChanged),this.changeEditable()},events:{"click .etch-bold":"toggleBold","click .etch-italic":"toggleItalic","click .etch-underline":"toggleUnderline","click .etch-heading":"toggleHeading","click .etch-unordered-list":"toggleUnorderedList","click .etch-justify-left":"justifyLeft","click .etch-justify-center":"justifyCenter","click .etch-justify-right":"justifyRight","click .etch-ordered-list":"toggleOrderedList","click .etch-link":"toggleLink","click .etch-image":"getImage","click .etch-save":"save","click .etch-clear-formatting":"clearFormatting",'click [data-option="fontSize"]':"setFontSize",'click [data-option="fontFamily"]':"setFontFamily"},_editableModelChanged:function(e,t){console.log(arguments)},changeEditable:function(){this.setButtonClass()},setButtonClass:function(){var e=this.model,t=e.get("editable").attr("data-button-class")||"default";e.set({buttons:i.config.buttonClasses[t]})},changeButtons:function(){console.log("Change btns"),this.$el.empty();var e=this,t=this.model.get("buttons");if(!t.length){$(this.el).hide();return}var n=e.$el;_.each(this.model.get("buttons"),function(t){if(t=="<group>")n=i.groupElFactory(),e.$el.append(n);else if(t=="</group>")n=e.$el;else{var r=i.buttonElFactory(t);n.append(r)}}),$(this.el).show("fast");var r=this.$el.find(".color-chooser");if(r.length>0){var s="333";r.ColorPicker({color:"#"+s,onChange:function(e,t,n){r.find("div").css("backgroundColor","#"+t),document.execCommand("foreColor",!1,t)}});var o=function(e){e.preventDefault()};$(".colorpicker").mousedown(o),r.mousedown(o),r.find("div").css("backgroundColor","#"+s)}var u=this.$el.find(".dropdown-toggle");u.dropdown()},changePosition:function(){var e=this.model.get("position");this.$el.animate({top:e.y,left:e.x},{queue:!1})},wrapSelection:function(e,t,n){var r=e===Range?e:e.getRangeAt(0),i=document.createElement(t);r.surroundContents(i)},clearFormatting:function(e){e.preventDefault(),document.execCommand("removeFormat",!1,null)},setFontFamily:function(e){e.preventDefault();var t=s(e);document.execCommand("fontName",!1,t),t=t.substr(t.indexOf("'")+1,t.lastIndexOf("'")-1),this.$el.find(".fontFamilyBtn .text").text(t)},setFontSize:function(e){var t=this.model.get("editableModel"),n=s(e);t.set("size",n|=0),this.$el.find(".fontSizeBtn .text").text(n)},toggleBold:function(e){e.preventDefault(),document.execCommand("bold",!1,null)},toggleItalic:function(e){e.preventDefault(),document.execCommand("italic",!1,null)},toggleUnderline:function(e){e.preventDefault(),document.execCommand("underline",!1,null)},toggleHeading:function(e){e.preventDefault();var t=window.getSelection().getRangeAt(0),n=t.commonAncestorContainer.parentElement;if($(n).is("h3")){$(n).replaceWith(n.textContent);return}var r=document.createElement("h3");t.surroundContents(r)},urlPrompt:function(e){var t=prompt("Enter a url","http://");/^((http|https)...)/.test(t)?e(t):e("http://"+t)},toggleLink:function(e){e.preventDefault();var t=window.getSelection().getRangeAt(0);t.startContainer.parentNode.tagName==="A"||t.endContainer.parentNode.tagName==="A"?document.execCommand("unlink",!1,null):this.urlPrompt(function(e){document.execCommand("createLink",!1,e)})},toggleUnorderedList:function(e){e.preventDefault(),document.execCommand("insertUnorderedList",!1,null)},toggleOrderedList:function(e){e.preventDefault(),document.execCommand("insertOrderedList",!1,null)},justifyLeft:function(e){e.preventDefault(),document.execCommand("justifyLeft",!1,null)},justifyCenter:function(e){e.preventDefault(),document.execCommand("justifyCenter",!1,null)},justifyRight:function(e){e.preventDefault(),document.execCommand("justifyRight",!1,null)},getImage:function(e){e.preventDefault(),this.startUploader(this.insertImage)},startUploader:function(e){var r=new t.ImageUploader,i=new n.ImageUploader({model:r});r._imageCallback=function(t){i.startCropper(t,e)},this._savedRange=window.getSelection().getRangeAt(0),$("body").append(i.render().el)},insertImage:function(e){var r=window.getSelection();r.removeAllRanges(),r.addRange(this._savedRange);var i={editable:this.model.get("editable"),editableModel:this.model.get("editableModel")};_.extend(i,e);var s=new t.EditableImage(i),o=new n.EditableImage({model:s});this._savedRange.insertNode($(o.render().el).addClass("etch-float-left")[0])},save:function(e){e.preventDefault();var t=this.model.get("editableModel");t.trigger("save")}}),_.extend(i,{models:t,views:n,collections:r,editableInit:function(e,r){e.stopPropagation();var s=e.target||e.srcElement,o=$(s).etchFindEditable(),u=$(".etch-editor-panel"),a=u.data("model");if(!u.size()){u=$('<div class="etch-editor-panel">');var f={editable:o,editableModel:this.model};document.body.appendChild(u[0]),u.etchInstantiate({classType:"Editor",attrs:f}),a=u.data("model")}else o[0]!==a.get("editable")[0]?(a.set({editable:o,editableModel:this.model}),u.css("display","block")):u.css("display","block");try{document.execCommand("StyleWithCSS",!1,!1)}catch(l){if(l.message!=="Invalid argument.")throw l}if(t.EditableImage){var c=o.find("img");if(c.size()){var h={editable:o,editableModel:this.model};c.each(function(){var e=$(this);if(!e.data("editableImageModel")){var r=new t.EditableImage(h),i=new n.EditableImage({model:r,el:this,tagName:this.tagName});e.data("editableImageModel",r)}})}}$("body").bind("mousedown.editor",function(e){var n=e.target||e.srcElement;$(n).not(".colorpicker *, .etch-editor-panel, .etch-editor-panel *, .etch-image-tools, .etch-image-tools *").size()&&(u.css("display","none"),t.EditableImage&&(o.find("img").unbind("mouseenter"),$(i.config.selector+" img").data("editableImageModel",!1)),$(this).unbind("mousedown.editor"))}),a.set({position:{x:e.pageX-15,y:r||e.pageY-80}})}}),$.fn.etchInstantiate=function(e,r){return this.each(function(){var i=$(this);e||(e={});var s={el:this,attrs:{}};_.extend(s,e);var o=new t[s.classType](s.attrs,s);if(_.isFunction(n[s.classType]))var u=new n[s.classType]({model:o,el:this,tagName:this.tagName});i.data({model:o}),i.data({view:u}),_.isFunction(r)&&r({model:o,view:u})})},i.buttonElFactory=function(e){return $('<a href="#" class="etch-editor-button etch-'+e+'" title="'+e.replace("-"," ")+'"><span></span></a>')},$.fn.etchFindEditable=function(){var e=$(this);return e.is(i.config.selector)?e:e.closest(i.config.selector)},i}),define("ui/editor/components/TextBoxView",["./ComponentView","vendor/amd/etch","../Templates"],function(e,t,n){var r;return r=["family","size","weight","style","color","decoration","align"],e.extend({className:"component textBox",tagName:"div",events:function(){var t,n;return n=e.prototype.events.call(this),t={dblclick:"dblclicked",editComplete:"editCompleted",mousedown:"mousedown"},_.extend(n,t)},initialize:function(){var t,n,i;e.prototype.initialize.apply(this,arguments);for(n=0,i=r.length;n<i;n++)t=r[n],this.model.on("change:"+t,this._styleChanged,this);return this._lastDx=0,this.model.on("edit",this.edit,this)},scaleStart:function(){},scale:function(e,t){var n,r;return n=this.model.get("size"),r=t.dx-this._lastDx>0?1:-1,this.model.set("size",n+Math.round(r*Math.sqrt(Math.abs(t.dx-this._lastDx)))),this._lastDx=t.dx},dblclicked:function(e){return this.$el.addClass("editable"),this.$el.find(".content").attr("contenteditable",!0),e!=null&&t.editableInit.call(this,e,this.model.get("y")*this.dragScale+35),this.allowDragging=!1,this.editing=!0},mousedown:function(n){return this.editing?t.editableInit.call(this,n,this.model.get("y")*this.dragScale+35):e.prototype.mousedown.apply(this,arguments),!0},editCompleted:function(){var e;return e=this.$textEl.html(),this.editing=!1,e===""?this.remove():(this.model.set("text",e),this.$el.find(".content").attr("contenteditable",!1),this.$el.removeClass("editable"),this.allowDragging=!0)},__selectionChanged:function(t,n){e.prototype.__selectionChanged.apply(this,arguments);if(!n&&this.editing)return this.editCompleted()},edit:function(){var e;return this.model.set("selected",!0),e=$.Event("click",{pageX:this.model.get("x")}),this.dblclicked(e),this.$el.find(".content").selectText()},_styleChanged:function(e,t,n){var r,i,s,o;s=n.changes,o=[];for(r in s)i=s[r],i?(r==="decoration"||r==="align"?(console.log("DECORATION CHANGE"),r="text"+r.substring(0,1).toUpperCase()+r.substr(1)):r!=="color"&&(r="font"+r.substr(0,1).toUpperCase()+r.substr(1)),o.push(this.$el.css(r,t))):o.push(void 0);return o},render:function(){return e.prototype.render.call(this),this.$textEl=this.$el.find(".content"),this.$textEl.html(this.model.get("text")),this.$el.css({fontFamily:this.model.get("family"),fontSize:this.model.get("size"),fontWeight:this.model.get("weight"),fontStyle:this.model.get("style"),color:"#"+this.model.get("color"),top:this.model.get("y"),left:this.model.get("x"),textDecoration:this.model.get("decoration"),textAlign:this.model.get("align")}),this.$el},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/components/WebFrameView",["./ComponentView"],function(e){return e.extend({className:"component webFrameView",initialize:function(){return e.prototype.initialize.apply(this,arguments)},render:function(){var t;return e.prototype.render.call(this),t=$("<iframe src="+this.model.get("src")+"></iframe>"),this.$el.find(".content").append(t),this.$el}})}),define("ui/editor/components/VideoView",["./ComponentView"],function(e){return e.extend({className:"component videoView",initialize:function(){return e.prototype.initialize.apply(this,arguments)},_finishRender:function(e){return this.origSize={width:e[0].videoWidth,height:e[0].videoHeight},this._setUpdatedTransform()},render:function(){var t,n=this;return e.prototype.render.call(this),t=$("<video controls></video>"),t.append("<source preload='metadata' src='"+this.model.get("src")+"' type='"+this.model.get("videoType")+"' />"),t.bind("loadedmetadata",function(){return n._finishRender(t)}),this.$el.find(".content").append(t),this.$el}})}),define("ui/editor/components/ComponentViewFactory",["./ImageView","./TableView","./TextBoxView","./WebFrameView","./VideoView"],function(e,t,n,r,i){var s;return s={createView:function(s){var o;o=s.get("type");switch(o){case"TextBox":return new n({model:s});case"ImageModel":return new e({model:s});case"Table":return new t({model:s});case"WebFrame":return new r({model:s});case"Video":return new i({model:s})}}}}),define("ui/editor/OperatingTable",["vendor/amd/backbone","./Templates","./components/ComponentViewFactory","vendor/amd/keymaster","ui/interactions/CutCopyPasteBindings","model/system/Clipboard","css!./res/css/OperatingTable.css"],function(e,t,n,r,i,s,o){return e.View.extend({className:"operatingTable",events:{click:"clicked",focused:"_focus"},initialize:function(){return i.applyTo(this,"operatingTable"),this._clipboard=new s},setModel:function(e){var t;return t=this.model,this.model!=null&&this.model.off(null,null,this),this.model=e,this.model!=null&&this.model.on("change:components.add",this._componentAdded,this),this.render(t)},resized:function(){var e,t,n,r,i,s;return n=window.slideConfig.size,r={width:this.$el.width(),height:this.$el.height()},i=r.width/n.width,s=(r.height-20)/n.height,e=n.height*i,e>r.height?t=s:t=i,this.$slideContainer.css(window.browserPrefix+"transform","scale("+t+")")},clicked:function(e){return this.model!=null&&(this.model.get("components").forEach(function(e){if(e.get("selected"))return e.set("selected",!1)}),this.$el.find(".editable").removeClass("editable").attr("contenteditable",!1).trigger("editComplete")),this._focus()},cut:function(){var e;e=this.model.lastSelection;if(e!=null)return this._clipboard.set("item",e),this.model.remove(e),e.set("selected",!1)},copy:function(){var e,t;e=this.model.lastSelection;if(e!=null)return t=e.clone(),t.set("x",e.get("x")+25),t.set("selected",!1),this._clipboard.set("item",t)},paste:function(){var e;if(this.$el.find(".editable").length!==0)return!0;e=this._clipboard.get("item");if(e!=null)return this.model.add(e.clone())},_focus:function(){if(r.getScope()!=="operatingTable")return r.setScope("operatingTable")},_componentAdded:function(e,t){var r;return r=n.createView(t),this.$slideContainer.append(r.render())},backgroundChanged:function(e){var t,n,r,i,s;i=e.styles,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this.$slideContainer.css("background-image",t));return s},render:function(e){var t,r=this;return e!=null&&e.trigger("unrender",!0),this.$el.html("<div class='slideContainer'></div>"),this.$slideContainer=this.$el.find(".slideContainer"),this.$slideContainer.css({width:window.slideConfig.size.width,height:window.slideConfig.size.height}),this.resized(),this.model!=null&&(t=this.model.get("components"),t.forEach(function(e){var t;return t=n.createView(e),r.$slideContainer.append(t.render())})),this.$el}})}),define("common/EventEmitter",[],function(){function e(){if(!(this instanceof e))return new e;this._events=null,typeof process!="undefined"&&typeof process.nextTick!="undefined"?this._deferer=function(e,t,n){process.nextTick(function(){e(t,n)})}:this._deferer=function(e,t,n){setTimeout(function(){e(t,n)},0)}}return e.prototype={_listeners:function(t){var n=this._events||(this._events={});return n[t]||(n[t]=[])},_emit:function(e,t){e instanceof Array&&(e=JSON.stringify(e));if(!this._events)return;var n=this._events[e];if(!n)return;var r=n.length;while(r--){var i=n[r];i&&i.cb.apply(i.context,t)}},_splice:function(e,t,n){return e=Array.prototype.slice.call(e),e.splice(t,n)},_indexOfSub:function(e,t,n){for(var r=0;r<e.length;++r)if(e[r].cb===t&&e[r].context===n)return r;return-1},emit:function(e){var t=arguments.length>1?this._splice(arguments,1,arguments.length):[];this._emit(e,t)},trigger:function(){this.emit.apply(this,arguments)},emitDeferred:function(e){var t=arguments.length>1?this._splice(arguments,1,arguments.length):[];this._deferer(emit,e,t)},on:function(e,t,n){if(!t)throw"Undefined callback provided";e instanceof Array&&(e=JSON.stringify(e));var r=this._listeners(e),i=this._indexOfSub(r,t,n);i<0&&(r.push({cb:t,context:n}),i=r.length-1);var s=this;return{dispose:function(){s.removeListener(e,t,n)}}},once:function(e,t,n){var r={sub:null};return r.sub=this.on(e,function(){r.sub.dispose(),t.apply(n,arguments)}),r.sub},removeListener:function(e,t,n){var r=this._listeners(e),i=this._indexOfSub(r,t,n);0<=i&&r.splice(i,1),r.length==0&&delete this._events[e]},getNumListeners:function(e){var t=0;return this._events[e]&&(t=this._events[e].length),t},off:function(e,t,n){this.removeListener(e,t,n)},removeAllListeners:function(){this._events=null}},e}),define("ui/editor/button_bar/AbstractButtonBarView",["vendor/amd/backbone"],function(e){return e.View.extend({initialize:function(e){return this.buttonBarOptions=e},optionChosen:function(e){var t;return t=$(e.currentTarget).attr("data-option"),this.buttonBarOptions[t].call(this,e)}})}),define("model/editor/button_bar/ButtonBarModel",["vendor/amd/backbone"],function(e){var t,n,r,i,s,o,u;n=["size","family","color","style","weight","decoration"],s=function(e){return n.indexOf(e)>2},t={};for(o=0,u=n.length;o<u;o++)i=n[o],r="font"+i.substr(0,1).toUpperCase()+i.substr(1),t[r]=function(){var e,t;return e=r,t=i,function(n){var r;if(this._activeIsTextbox())return console.log("Setting: "+e+" "+t+" "+n),r=this.get(e),r===n&&s(t)&&(n=""),t==="size"&&(n|=0),this.set(e,n),this.activeComponent.set(t,n)}}();return e.Model.extend({initialize:function(){return this.fetch({keyTrail:["editor","slideEditor","buttonBar"]}),_.extend(this,t)},fontConfig:function(){return{size:this.get("fontSize"),family:this.get("fontFamily"),color:this.get("fontColor"),style:this.get("fontStyle"),weight:this.get("fontWeight"),decoration:this.get("fontDecoration")}},itemConfig:function(e){return{src:e}},textAlign:function(e){this.set("textAlign",e);if(this._activeIsTextbox())return this.activeComponent.set("align",e)},_activeIsTextbox:function(){return this.activeComponent&&this.activeComponent.get("type")==="TextBox"},_pullFontSettings:function(){var e,t,r;r=[];for(e=0,t=n.length;e<t;e++)i=n[e],r.push(this.set("font"+i.substr(0,1).toUpperCase()+i.substr(1),this.activeComponent.get(i)));return r},_bindActiveText:function(){return this.activeComponent.on("change:size",this._activeFontSizeChanged,this)},_activeFontSizeChanged:function(e,t){return this.set("fontSize",t)},colorSelected:function(e){this.set("fontColor",e);if(this._activeIsTextbox())return this.activeComponent.set("color",e)},activeComponentChanged:function(e){this.activeComponent!=null&&this.activeComponent.off(null,null,this),this.activeComponent=e;if(this._activeIsTextbox())return this._pullFontSettings(),this._bindActiveText()},constructor:function(){e.Model.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/button_bar/ButtonBarView",["./AbstractButtonBarView","model/editor/button_bar/ButtonBarModel","model/presentation/components/ComponentFactory"],function(e,t,n){var r,i;return i=["size","family","weight","style","decoration"],r={_extractValue:function(e){var t,n;return n=e.target.dataset.value,n==null&&(t=$(e.target),n=t.parent()[0].dataset.value),n},createSlide:function(){return this.deck.newSlide()},textBox:function(){var e,t;e=this.deck.get("activeSlide");if(e!=null)return t=n.createTextBox(this.model.fontConfig()),e.add(t),t.trigger("edit")},picture:function(){var e,t=this;e=this.deck.get("activeSlide");if(e!=null)return this.options.pictureGrabber.show(function(r){return e.add(n.createImage(t.model.itemConfig(r)))})},iframe:function(){var e,t=this;e=this.deck.get("activeSlide");if(e!=null)return this.options.siteGrabber.show(function(r){var i;return i=n.createWebFrame(t.model.itemConfig(r)),e.add(i)})},video:function(){var e,t=this;e=this.deck.get("activeSlide");if(e!=null)return this.options.videoGrabber.show(function(r){var i;return i=n.createVideo(t.model.itemConfig(r)),e.add(i)})},table:function(){},shapes:function(){},chart:function(){},transitionEditor:function(){return this.$el.trigger("changePerspective",{perspective:"transitionEditor"})},preview:function(){return this.$el.trigger("preview")},textAlign:function(e){return this.model.textAlign(e.currentTarget.dataset.value)}},i.forEach(function(e){var t;return t="font"+e.substr(0,1).toUpperCase()+e.substr(1),r[t]=function(){var e;return e=t,function(t){var n;return n=r._extractValue(t),this.model[e](n)}}()}),e.extend({events:function(){return{"click *[data-option]":"optionChosen"}},initialize:function(){return e.prototype.initialize.call(this,r),this.deck=this.options.deck,this.deck.on("change:activeSlide",this.activeSlideChanged,this),this.model=new t,this.model.on("change:fontSize",this._fontSizeChanged,this),this.model.on("change:fontFamily",this._fontFamilyChanged,this)},_fontFamilyChanged:function(e,t){return t=t.substr(t.indexOf("'")+1,t.lastIndexOf("'")-1),this.$el.find(".fontFamilyBtn .text").text(t)},_fontSizeChanged:function(e,t){return this.$el.find(".fontSizeBtn .text").text(t)},activeSlideChanged:function(e,t){this.currentSlide&&this.currentSlide.off("change:activeSlide",this.activeSlideChanged,this),this.currentSlide=t;if(t)return t.on("change:activeComponent",this.activeComponentChanged,this)},activeComponentChanged:function(e,t){return this.model.activeComponentChanged(t),t?this.$el.find(".fontButton").removeClass("disabled"):this.$el.find(".fontButton").addClass("disabled")},dispose:function(){return this.currentSlide&&this.currentSlide.off("change:activeSlide",this.activeSlideChanged,this),this.deck.off("change:activeSlide",this.activeSlideChanged,this)},render:function(){var e,t,n=this;return e=this.$el.find(".color-chooser"),t="333",e.ColorPicker({color:"#"+t,onChange:function(t,r,i){return e.find("div").css("backgroundColor","#"+r),n.model.colorSelected(r)}}),e.find("div").css("backgroundColor","#"+t),this.model.colorSelected(t),this.$el}})}),define("ui/widgets/Templates",["vendor/amd/Handlebars"],function(e){return{BackgroundPicker:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="modal-header">	<button class="close" data-dismiss="modal">×</button>	<h3>Change Background</h3></div><div class="modal-body">	<div class="pull-left">		<div><h4>Gradient</h4></div>		<div class="gradientPicker">		</div>		<div class="gradientOptions">			<div class="btn-group">	  			<button class="btn">Type</button>	  			<button class="btn dropdown-toggle" data-toggle="dropdown">	    			<span class="caret"></span>	  			</button>	  			<ul class="dropdown-menu" data-option="type">	    			<li><a href="#" data-value="linear">Linear</a></li>	    			<li><a href="#" data-value="radial">Radial</a></li>	  			</ul>			</div>			<div class="btn-group">	  			<button class="btn">Direction</button>	  			<button class="btn dropdown-toggle" data-toggle="dropdown">	    			<span class="caret"></span>	  			</button>	  			<ul class="dropdown-menu" data-option="direction">	    			<li><a href="#" data-value="top">Top</a></li>	    			<li><a href="#" data-value="left">Left</a></li>	    			<li><a href="#" data-value="15deg">15&deg;</a></li>	    			<li><a href="#" data-value="30deg">30&deg;</a></li>	    			<li><a href="#" data-value="45deg">45&deg;</a></li>	    			<li><a href="#" data-value="105deg">105&deg;</a></li>	    			<li><a href="#" data-value="120deg">120&deg;</a></li>	    			<li><a href="#" data-value="135deg">135&deg;</a></li>	  			</ul>			</div>		</div>	</div>	<div class="pull-left bgPreview">		<div><h4>Background Preview</h4></div>		<div class="gradientPreview">		</div>	</div>	<div style="clear: both"></div></div><div class="modal-footer">	<a href="#" class="btn btn-inverse ok">OK</a>	<a href="#" class="btn" data-dismiss="modal">Cancel</a></div>'}),ItemGrabber:e.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="modal-header">	<button class="close" data-dismiss="modal">×</button>	<h3>',u=n.title,u?o=u.call(t,{hash:{}}):(o=t.title,o=typeof o===a?o():o),s+=f(o)+'</h3></div><div class="modal-body">	<div class="alert alert-error disp-none">  		<button class="close" data-dismiss="alert">×</button>  		The image URL you entered appears to be incorrect	</div>	<h4>URL:</h4><input type="text" name="itemUrl"></input>	<h4>Preview:</h4>	<ul class="thumbnails">		<li class="span4">			<div class="thumbnail">				<',u=n.tag,u?o=u.call(t,{hash:{}}):(o=t.tag,o=typeof o===a?o():o),s+=f(o)+' class="preview" width="360" height"268"></',u=n.tag,u?o=u.call(t,{hash:{}}):(o=t.tag,o=typeof o===a?o():o),s+=f(o)+'>			</div>		</li>	</ul></div><div class="modal-footer">	<a href="#" class="btn btn-primary ok btn-inverse">',u=n.title,u?o=u.call(t,{hash:{}}):(o=t.title,o=typeof o===a?o():o),s+=f(o)+"</a></div>",s}),OpenDialog:e.template(function(e,t,n,r,i){function l(e,t){var n="";return n+='			<li><a href="#"><span>',e=typeof e===u?e():e,n+=a(e)+'</span><button class="close">x</button></a></li>		',n}n=n||e.helpers;var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="modal-header">	<button class="close" data-dismiss="modal">×</button>	<h3>Open</h3></div><div class="modal-body">	<ul class="nav nav-list">		',o=t.fileNames,o=n.each.call(t,o,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;return s+='	</ul></div><div class="modal-footer">	<a href="#" class="btn btn-inverse ok">OK</a>	<a href="#" class="btn" data-dismiss="modal">Cancel</a></div>',s}),RawTextImporter:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="modal-header">	<button class="close" data-dismiss="modal">×</button>	<h3>Import/Export Show (from/to JSON)</h3></div><div class="modal-body">	<h4>JSON string</h4>	<textarea style="width: 100%; height: 100%" rows="10"></textarea></div><div class="modal-footer">	<a href="#" class="btn btn-inverse ok">OK</a></div>'}),SaveAsDialog:e.template(function(e,t,n,r,i){function l(e,t){var n="";return n+='					<li><a href="#"><span>',e=typeof e===u?e():e,n+=a(e)+'</span><button class="close">x</button></a></li>				',n}function c(e,t){var n="";return n+='					<li><a href="#"><span>',e=typeof e===u?e():e,n+=a(e)+'</span><button class="close">x</button></a></li>				',n}n=n||e.helpers;var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="modal-header">	<button class="close" data-dismiss="modal">×</button>	<h3>Save as...</h3></div><div class="modal-body">	<!-- <ul class="nav nav-tabs">  		<li class="active"><a href="#saveLocalTab">Local</a></li>  		<li><a href="#saveRemoteTab">Remote</a></li>	</ul> -->	<!-- <div class="tab-content">  		<div class="tab-pane active" id="saveLocalTab"> -->		  	<h4>Name</h4>			<input type="text"></input>			<ul class="nav nav-list">				',o=t.fileNames,o=n.each.call(t,o,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;s+='			</ul>  		<!-- </div>  		<div class="tab-pane" id="saveRemoteTab">  			<h4>Name</h4>			<input type="text"></input>			<ul class="nav nav-list">				',o=t.fileNames,o=n.each.call(t,o,{hash:{},inverse:f.noop,fn:f.program(3,c,i)});if(o||o===0)s+=o;return s+='			</ul>  		</div>	</div> --></div><div class="modal-footer">	<a href="#" class="btn btn-inverse ok">OK</a>	<a href="#" class="btn" data-dismiss="modal">Cancel</a></div>',s})}}),define("ui/widgets/ItemGrabber",["vendor/amd/backbone","./Templates","common/Throttler"],function(e,t,n){return e.View.extend({className:"itemGrabber modal",events:{"click .ok":"okClicked","keyup input[name='itemUrl']":"urlChanged","paste input[name='itemUrl']":"urlChanged",hidden:"hidden"},initialize:function(){return this.throttler=new n(200,this)},show:function(e){return this.cb=e,this.$el.modal("show")},okClicked:function(){if(!this.$el.find(".ok").hasClass("disabled"))return this.cb(this.src),this.$el.modal("hide")},hidden:function(){if(this.$input!=null)return this.$input.val("")},urlChanged:function(e){return e.which===13?(this.src=this.$input.val(),this.okClicked()):this.throttler.submit(this.loadItem,{rejectionPolicy:"runLast"})},loadItem:function(){return this.item.src=this.$input.val(),this.src=this.item.src},_itemLoadError:function(){return this.$el.find(".ok").addClass("disabled"),this.$el.find(".alert").removeClass("disp-none")},_itemLoaded:function(){return this.$el.find(".ok").removeClass("disabled"),this.$el.find(".alert").addClass("disp-none")},render:function(){var e=this;return this.$el.html(t.ItemGrabber(this.options)),this.$el.modal(),this.$el.modal("hide"),this.item=this.$el.find(this.options.tag)[0],this.options.tag==="video"&&this.$el.find(".modal-body").prepend("<div class='alert alert-success'>Supports <strong>mp4, webm</strong>.<br/>Try out: http://clips.vorwaerts-gmbh.de/VfE_html5.mp4 <br/>or: http://media.w3.org/2010/05/sintel/trailer.mp4</div>"),this.options.ignoreErrors||(this.item.onerror=function(){return e._itemLoadError()},this.item.onload=function(){return e._itemLoaded()}),this.$input=this.$el.find("input[name='itemUrl']"),this.$el},constructor:function(){e.View.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/SlideEditor",["vendor/amd/backbone","./Templates","./SlidePreviewPanel","./OperatingTable","common/EventEmitter","css!./res/css/SlideEditor.css","./button_bar/ButtonBarView","ui/widgets/ItemGrabber","vendor/amd/keymaster"],function(e,t,n,r,i,s,o,u,a){return e.View.extend({className:"slideEditor",initialize:function(){var e=this;return this.name="Slide Editor",$(window).resize(function(){return e.resized()}),this.operatingTable=new r,this.slidePreviewPanel=new n({model:this.model}),this.model.on("change:activeSlide",this._activeSlideChanged,this)},show:function(){this.hidden=!1,this.$el.removeClass("disp-none"),a.setScope("slidePreviewPanel");if(this.hiddenActiveChange!=null)return this.operatingTable.setModel(this.hiddenActiveChange),this.hiddenActiveChange=null},cut:function(){var e;return e=this[a.getScope()],e!=null&&e.cut(),!0},copy:function(){var e;return e=this[a.getScope()],e!=null&&e.copy(),!0},paste:function(){var e;return e=this[a.getScope()],e!=null&&e.paste(),!0},backgroundChanged:function(e){return this.operatingTable.backgroundChanged(e)},hide:function(){return this.hidden=!0,this.$el.addClass("disp-none")},_activeSlideChanged:function(e,t){return this.hidden?this.hiddenActiveChange=t:this.operatingTable.setModel(t)},render:function(){var e,n,r,i,s;return this.$el.html(t.SlideEditor(this.model)),this.$el.find(".dropdown-toggle").dropdown(),e=this.$el.find("a[title]"),e.tooltip({placement:"bottom",delay:{show:1e3,hide:100}}).click(function(){return e.tooltip("hide")}),n=this.$el.find(".mainContent"),this.$slidePreviewPanel=this.slidePreviewPanel.render(),this.$operatingTable=this.operatingTable.render(),n.append(this.$slidePreviewPanel),n.append(this.$operatingTable),this.resized(),this._buttonBar!=null&&this._buttonBar.dispose(),r=new u({tag:"img",title:"Insert Image"}),i=new u({tag:"iframe",title:"Insert Website"}),s=new u({tag:"video",title:"Insert Video",ignoreErrors:!0}),this.$el.append(r.render()),this.$el.append(i.render()),this.$el.append(s.render()),this._buttonBar=new o({el:this.$el.find(".buttonBar"),deck:this.model,pictureGrabber:r,siteGrabber:i,videoGrabber:s}),this._buttonBar.render(),this.$el},resized:function(){if(this.$operatingTable)return this.$slidePreviewPanel.css("height",window.innerHeight-80),this.$operatingTable.css({height:window.innerHeight-80,width:window.innerWidth-150}),this.operatingTable.resized()}})}),define("ui/editor/components/ThreeDRotableComponentView",["./ComponentView","../Templates","common/Math2"],function(e,t,n){var r;return r=Math.PI*2,e.extend({transforms:["rotateX","rotateY","rotateZ","scale"],events:function(){return{mousedown:"mousedown",click:"clicked","deltadrag span[data-delta='rotateX']":"rotateX","deltadrag span[data-delta='rotateY']":"rotateY","deltadrag span[data-delta='rotateZ']":"rotateZ","deltadragStart span[data-delta='rotateX']":"rotateXStart","deltadragStart span[data-delta='rotateY']":"rotateYStart","deltadragStart span[data-delta='rotateZ']":"rotateZStart","change input[data-option='z']":"manualMoveZ","change input[data-option='scale']":"manualMoveScale","change input[data-option='rotateX']":"manualRotX","change input[data-option='rotateY']":"manualRotY","change input[data-option='rotateZ']":"manualRotZ"}},initialize:function(){return e.prototype.initialize.apply(this,arguments),this.model.on("change:rotateX",this._rotXChanged,this),this.model.on("change:rotateY",this._rotYChanged,this),this.model.on("change:rotateZ",this._rotZChanged,this)},rotateX:function(e,t){var n;return n=t.dy*.02%r,this.model.setFloat("rotateX",this._initialRotX+n)},rotateY:function(e,t){var n;return n=t.dx*.02%r,this.model.setFloat("rotateY",this._initialRotY+n)},rotateZ:function(e,t){var n;return n=this._calcRot(t),this.model.setFloat("rotateZ",this._initialRotZ+n-this._rotZOffset)},manualMoveScale:function(e){return this.model.setFloat("impScale",e.target.value)},manualMoveZ:function(e){return this.model.setInt("z",e.target.value)},manualRotX:function(e){return this.model.setFloat("rotateX",n.toRads(e.target.value))},manualRotY:function(e){return this.model.setFloat("rotateY",n.toRads(e.target.value))},manualRotZ:function(e){return this.model.setFloat("rotateZ",n.toRads(e.target.value))},rotateXStart:function(e,t){return this.updateOrigin(),this._rotXOffset=this._calcRot(t),this._initialRotX=this.model.get("rotateX")||0},rotateYStart:function(e,t){return this.updateOrigin(),this._rotYOffset=this._calcRot(t),this._initialRotY=this.model.get("rotateY")||0},rotateZStart:function(e,t){return this.updateOrigin(),this._rotZOffset=this._calcRot(t),this._initialRotZ=this.model.get("rotateZ")||0},render:function(){return e.prototype.render.apply(this,arguments),this.$rotXInput=this.$el.find("[data-option='rotateX']"),this.$rotYInput=this.$el.find("[data-option='rotateY']"),this.$rotZInput=this.$el.find("[data-option='rotateZ']")},_rotXChanged:function(e,t){return this.$rotXInput.val(n.round(n.toDeg(t),2)),this._setUpdatedTransform()},_rotYChanged:function(e,t){return this.$rotYInput.val(n.round(n.toDeg(t),2)),this._setUpdatedTransform()},_rotZChanged:function(e,t){return this.$rotZInput.val(n.round(n.toDeg(t),2)),this._setUpdatedTransform()},__getTemplate:function(){return t.ThreeDRotableComponentView},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/transition_editor/TransitionSlideSnapshot",["../components/ThreeDRotableComponentView","../Templates","../raster/SlideDrawer","css!../res/css/TransitionSlideSnapshot.css"],function(e,t,n,r){return e.extend({className:"component transitionSlideSnapshot",events:function(){var t;return t=e.prototype.events(),_.extend(t,{click:"clicked"})},initialize:function(){return e.prototype.initialize.apply(this,arguments)},remove:function(){return e.prototype.remove.call(this,!0),this.slideDrawer!=null&&this.slideDrawer.dispose(),this.model.set("selected",!1)},clicked:function(){return e.prototype.clicked.apply(this,arguments),this.model.set("active",!0)},render:function(){var t;return e.prototype.render.apply(this,arguments),this.slideDrawer!=null&&this.slideDrawer.dispose(),t=this.$el.find("canvas")[0].getContext("2d"),this.slideDrawer=new n(this.model,t),this.slideDrawer.repaint(),this.$el.css({left:this.model.get("x"),top:this.model.get("y")}),this.$el},__getTemplate:function(){return t.TransitionSlideSnapshot},constructor:function(){e.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/transition_editor/TransitionEditorButtonBarView",["../button_bar/AbstractButtonBarView","common/Math2"],function(e,t){var n;return n={rotateX:function(e){var t;t=parseFloat(e.target.value);if(!isNaN(t))return this.model.changeSlideRotations(t)},rotateY:function(e){var t;t=parseFloat(e.target.value);if(!isNaN(t))return this.model.changeSlideRotations(null,t)},rotateZ:function(e){var t;t=parseFloat(e.target.value);if(!isNaN(t))return this.model.changeSlideRotations(null,null,t)},interval:function(e){var t;t=parseInt(e.target.value);if(!isNaN(t))return this.model.setInterval(t)},slideEditor:function(e){return this.$el.trigger("changePerspective",{perspective:"slideEditor"})},preview:function(e){return this.$el.trigger("preview")},lookDownZ:function(e){},lookDownY:function(e){},lookDownX:function(e){}},e.extend({events:function(){return{"keyup *[data-option]":"optionChosen","paste *[data-option]":"optionChosen","click .btn[data-option]":"optionChosen",click:"clicked"}},initialize:function(){return e.prototype.initialize.call(this,n)},_slideRotationsChanged:function(e,t){return this.partialRender(t)},clicked:function(e){return e.stopPropagation(),!1},partialRender:function(e,t){e||(e=this.model.slideRotations());if(e!=null)return this.updateRotationControls(this.$slideRotCtrls,e)},updateRotationControls:function(e,n){return e.each(function(e,r){var i;i=n[e];if(i==null||isNaN(i))i=0;return $(r).val(t.round(i,2))})},render:function(){return this.$slideRotCtrls=this.$el.find(".slideRotations input"),this.partialRender()}})}),define("model/editor/transition_editor/TransitionEditorButtonBarModel",["vendor/amd/backbone"],function(e){var t,n;return n=180/Math.PI,t={silent:!0},e.Model.extend({initialize:function(){var e;return e=this.get("deck"),e.on("change:activeSlide",this._activeSlideChanged,this),this._lastActive=null,this._activeSlideChanged(e,e.get("activeSlide"))},_activeSlideChanged:function(e,t){return this._lastActive!=null&&this._lastActive.off(null,null,this),this._lastActive=t},_slideRotationChanged:function(e,t){return this.trigger("change:slideRotations",this,this.slideRotations())},slideRotations:function(){var e;return e=this._lastActive,e!=null?[e.get("rotateX")*n,e.get("rotateY")*n,e.get("rotateZ")*n]:[0,0,0]},setInterval:function(e){return e*=1e3,this.get("deck").set("interval",e)},changeSlideRotations:function(e,r,i){var s,o;s=this._lastActive;if(s!=null)return o={},e!=null&&(o.rotateX=e/n),r!=null&&(o.rotateY=r/n),i!=null&&(o.rotateZ=i/n),s.set(o,t),s.trigger("rerender")},constructor:function(){e.Model.prototype.constructor.apply(this,arguments)}})}),define("ui/editor/transition_editor/TransitionEditor",["vendor/amd/backbone","./TransitionSlideSnapshot","../Templates","./TransitionEditorButtonBarView","model/editor/transition_editor/TransitionEditorButtonBarModel","vendor/amd/keymaster","ui/interactions/CutCopyPasteBindings","../SlideCopyPaste","model/system/Clipboard","css!../res/css/TransitionEditor.css"],function(e,t,n,r,i,s,o,u,a,f){return e.View.extend({className:"transitionEditor",events:{click:"clicked"},scale:window.slideConfig.size.width/150,initialize:function(){return this.name="Transition Editor",this._snapshots=[],this._clipboard=new a,_.extend(this,u),o.applyTo(this,"transitionEditor")},show:function(){return this.hidden=!1,this.$el.removeClass("disp-none"),s.setScope("transitionEditor"),this._partialRender()},resized:function(){},hide:function(){return this.hidden=!0,this._disposeOldView(),this.$el.addClass("disp-none")},clicked:function(){return this.model.get("slides").forEach(function(e){if(e.get("selected"))return e.set("selected",!1)})},backgroundChanged:function(e){},_disposeOldView:function(){return this._snapshots.forEach(function(e){return e.remove()}),this._snapshots=[]},render:function(){return this.$el.html(n.TransitionEditor()),this.buttonBarView=new r({model:new i({deck:this.model}),el:this.$el.find(".navbar")}),this.buttonBarView.render(),this._partialRender(),this.$el},_partialRender:function(){var e,n,r,i,s=this;return this.buttonBarView.partialRender(),e=this.$el.find(".transitionSlides"),e.html(""),i=this.model.get("slides"),r=6,n=0,i.each(function(i){var o,u;return u=i.get("x"),u==null&&(i.set("x",n*160+30),i.set("y",(n/r|0)*160+80)),++n,o=new t({model:i}),s._snapshots.push(o),e.append(o.render())})}})}),define("ui/impress_renderer/Templates",["vendor/amd/Handlebars"],function(e){return{ComponentContainer:e.template(function(e,t,n,r,i){function l(e,t){var n="";return n}function c(e,t){var n="";return n}function h(e,t){var r="",i,s;r+="scale(",i=e.scale,i=i==null||i===!1?i:i.x,s=n.round,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(6,p,t)}):f.call(e,"round",i,{hash:{},inverse:a.noop,fn:a.program(6,p,t)});if(i||i===0)r+=i;r+=", ",i=e.scale,i=i==null||i===!1?i:i.y,s=n.round,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(8,d,t)}):f.call(e,"round",i,{hash:{},inverse:a.noop,fn:a.program(8,d,t)});if(i||i===0)r+=i;return r+=")",r}function p(e,t){var n="";return n}function d(e,t){var n="";return n}function v(e,t){var r="",i,s;r+="scale(",i=e.scale,i=i==null||i===!1?i:i.x,s=n.round,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(11,m,t)}):f.call(e,"round",i,{hash:{},inverse:a.noop,fn:a.program(11,m,t)});if(i||i===0)r+=i;r+=", ",i=e.scale,i=i==null||i===!1?i:i.y,s=n.round,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(13,g,t)}):f.call(e,"round",i,{hash:{},inverse:a.noop,fn:a.program(13,g,t)});if(i||i===0)r+=i;return r+=")",r}function m(e,t){var n="";return n}function g(e,t){var n="";return n}function y(e,t){var r="",i,s;r+="scale(",i=e.scale,i=i==null||i===!1?i:i.x,s=n.round,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(16,b,t)}):f.call(e,"round",i,{hash:{},inverse:a.noop,fn:a.program(16,b,t)});if(i||i===0)r+=i;r+=", ",i=e.scale,i=i==null||i===!1?i:i.y,s=n.round,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(18,w,t)}):f.call(e,"round",i,{hash:{},inverse:a.noop,fn:a.program(18,w,t)});if(i||i===0)r+=i;return r+=")",r}function b(e,t){var n="";return n}function w(e,t){var n="";return n}n=n||e.helpers,r=r||e.partials;var s="",o,u,a=this,f=n.helperMissing;s+='<div class="componentContainer" style="top: ',o=t.y,u=n.round,o=u?u.call(t,o,{hash:{},inverse:a.noop,fn:a.program(1,l,i)}):f.call(t,"round",o,{hash:{},inverse:a.noop,fn:a.program(1,l,i)});if(o||o===0)s+=o;s+="px; left: ",o=t.x,u=n.round,o=u?u.call(t,o,{hash:{},inverse:a.noop,fn:a.program(3,c,i)}):f.call(t,"round",o,{hash:{},inverse:a.noop,fn:a.program(3,c,i)});if(o||o===0)s+=o;s+="px;-webkit-transform: ",o=t.scale,o=n["if"].call(t,o,{hash:{},inverse:a.noop,fn:a.program(5,h,i)});if(o||o===0)s+=o;s+=";-moz-transform: ",o=t.scale,o=n["if"].call(t,o,{hash:{},inverse:a.noop,fn:a.program(10,v,i)});if(o||o===0)s+=o;s+=";transform: ",o=t.scale,o=n["if"].call(t,o,{hash:{},inverse:a.noop,fn:a.program(15,y,i)});if(o||o===0)s+=o;s+='">',o=t,o=a.invokePartial(r.TransformContainer,"TransformContainer",o,n,r);if(o||o===0)s+=o;return s}),Image:e.template(function(e,t,n,r,i){n=n||e.helpers,r=r||e.partials;var s="",o,u,a=this,f="function",l=this.escapeExpression;o=t,o=a.invokePartial(r.ComponentContainer,"ComponentContainer",o,n,r);if(o||o===0)s+=o;return s+='<img src="',u=n.src,u?o=u.call(t,{hash:{}}):(o=t.src,o=typeof o===f?o():o),s+=l(o)+'"></img></div></div>',s}),ImpressTemplate:e.template(function(e,t,n,r,i){function p(e,t){var n="";return n}function d(e,t){var r="",i,s;r+="",s=n.attributes,s?i=s.call(e,{hash:{},inverse:a.noop,fn:a.program(4,v,t)}):(i=e.attributes,i=typeof i===l?i():i),n.attributes||(i=h.call(e,i,{hash:{},inverse:a.noop,fn:a.program(4,v,t)}));if(i||i===0)r+=i;return r+="</div>",r}function v(e,t){var r="",i,s;r+='<div class="step" data-x="',i=e.x,s=n.scaleX,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(5,m,t)}):f.call(e,"scaleX",i,{hash:{},inverse:a.noop,fn:a.program(5,m,t)});if(i||i===0)r+=i;r+='" data-y="',i=e.y,s=n.scaleY,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(7,g,t)}):f.call(e,"scaleY",i,{hash:{},inverse:a.noop,fn:a.program(7,g,t)});if(i||i===0)r+=i;r+='" ',i=e.rotateX,i=n["if"].call(e,i,{hash:{},inverse:a.noop,fn:a.program(9,y,t)});if(i||i===0)r+=i;r+="  ",i=e.rotateY,i=n["if"].call(e,i,{hash:{},inverse:a.noop,fn:a.program(12,w,t)});if(i||i===0)r+=i;r+=" ",i=e.rotateZ,i=n["if"].call(e,i,{hash:{},inverse:a.noop,fn:a.program(15,S,t)});if(i||i===0)r+=i;r+=" ",i=e.z,i=n["if"].call(e,i,{hash:{},inverse:a.noop,fn:a.program(18,T,t)});if(i||i===0)r+=i;r+=" ",i=e.impScale,i=n["if"].call(e,i,{hash:{},inverse:a.noop,fn:a.program(20,N,t)});if(i||i===0)r+=i;r+='><div style="width: 1024px; height: 768px">',s=n.components,s?i=s.call(e,{hash:{},inverse:a.noop,fn:a.program(22,C,t)}):(i=e.components,i=typeof i===l?i():i),n.components||(i=h.call(e,i,{hash:{},inverse:a.noop,fn:a.program(22,C,t)}));if(i||i===0)r+=i;return r+="</div>",r}function m(e,t){var n="";return n}function g(e,t){var n="";return n}function y(e,t){var r="",i,s;r+='data-rotate-x="',i=e.rotateX,s=n.toDeg,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(10,b,t)}):f.call(e,"toDeg",i,{hash:{},inverse:a.noop,fn:a.program(10,b,t)});if(i||i===0)r+=i;return r+='"',r}function b(e,t){var n="";return n}function w(e,t){var r="",i,s;r+='data-rotate-y="',i=e.rotateY,s=n.toDeg,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(13,E,t)}):f.call(e,"toDeg",i,{hash:{},inverse:a.noop,fn:a.program(13,E,t)});if(i||i===0)r+=i;return r+='"',r}function E(e,t){var n="";return n}function S(e,t){var r="",i,s;r+='data-rotate-z="',i=e.rotateZ,s=n.toDeg,i=s?s.call(e,i,{hash:{},inverse:a.noop,fn:a.program(16,x,t)}):f.call(e,"toDeg",i,{hash:{},inverse:a.noop,fn:a.program(16,x,t)});if(i||i===0)r+=i;return r+='"',r}function x(e,t){var n="";return n}function T(e,t){var r="",i,s;return r+='data-z="',s=n.z,s?i=s.call(e,{hash:{}}):(i=e.z,i=typeof i===l?i():i),r+=c(i)+'"',r}function N(e,t){var r="",i,s;return r+='data-scale="',s=n.impScale,s?i=s.call(e,{hash:{}}):(i=e.impScale,i=typeof i===l?i():i),r+=c(i)+'"',r}function C(e,t){var r="",i,s;r+="",s=n.renderComponent,i=s?s.call(e,e,{hash:{},inverse:a.noop,fn:a.program(23,k,t)}):f.call(e,"renderComponent",e,{hash:{},inverse:a.noop,fn:a.program(23,k,t)});if(i||i===0)r+=i;return r+="",r}function k(e,t){var n="";return n}function L(e,t){var n="";return n+="<script>var interval = ",e=typeof e===l?e():e,n+=c(e)+";if (interval >= 1000) {    setInterval(function() {        impress().next();    }, interval);}</script>",n}n=n||e.helpers;var s="",o,u,a=this,f=n.helperMissing,l="function",c=this.escapeExpression,h=n.blockHelperMissing;s+='<head><meta charset="utf-8" /><meta name="viewport" content="width=1024" /><meta name="apple-mobile-web-app-capable" content="yes" /><title>Deck Title</title><meta name="description" content="TODO" /><meta name="author" content="TODO" /><style>.componentContainer {    position: absolute;    -webkit-transform-origin: 0 0;    -moz-transform-origin: 0 0;    transform-origin: 0 0;}.bg {    width: 100%;    height: 100%;}</style><link href="preview_export/css/main.css" rel="stylesheet" /><link href=\'preview_export/css/web-fonts.css\' rel=\'stylesheet\' type=\'text/css\'><link rel="shortcut icon" href="favicon.png" /><link rel="apple-touch-icon" href="apple-touch-icon.png" /></head><body class="impress-not-supported"><!-- This is a work around / hack to get the user\'s browser to download the fonts  if they decide to save the presentation. --><div style="visibility: hidden; width: 0px; height: 0px"><img src="preview_export/css/Lato-Bold.woff" /><img src="preview_export/css/HammersmithOne.woff" /><img src="preview_export/css/Gorditas-Regular.woff" /><img src="preview_export/css/FredokaOne-Regular.woff" /><img src="preview_export/css/Ubuntu.woff" /><img src="preview_export/css/Ubuntu-Bold.woff" /><img src="preview_export/css/PressStart2P-Regular.woff" /><img src="preview_export/css/Lato-BoldItalic.woff" /><img src="preview_export/css/AbrilFatface-Regular.woff" /><img src="preview_export/css/Lato-Regular.woff" /></div><div class="fallback-message">    <p>Your browser <b>doesn\'t support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>    <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p></div><div class="bg" style="',o=t.background,o=o==null||o===!1?o:o.styles,u=n.extractBG,o=u?u.call(t,o,{hash:{},inverse:a.noop,fn:a.program(1,p,i)}):f.call(t,"extractBG",o,{hash:{},inverse:a.noop,fn:a.program(1,p,i)});if(o||o===0)s+=o;s+='"><div id="impress">',o=t.slides,o=o==null||o===!1?o:o.models,o=typeof o===l?o():o,o=o=h.call(t,o,{hash:{},inverse:a.noop,fn:a.program(3,d,i)});if(o||o===0)s+=o;s+='</div><div class="hint">    <p>Use a spacebar or arrow keys to navigate</p></div><script>if ("ontouchstart" in document.documentElement) {     document.querySelector(".hint").innerHTML = "<p>Tap on the left or right to navigate</p>";}</script>',u=n.interval,u?o=u.call(t,{hash:{},inverse:a.noop,fn:a.program(25,L,i)}):(o=t.interval,o=typeof o===l?o():o),n.interval||(o=h.call(t,o,{hash:{},inverse:a.noop,fn:a.program(25,L,i)}));if(o||o===0)s+=o;return s+='</div><script type="text/javascript" src="preview_export/scripts/impress.js"></script><script>if (!window.impressStarted) {    startImpress(document, window);    impress().init();   }</script></body>',s}),SVGContainer:e.template(function(e,t,n,r,i){n=n||e.helpers,r=r||e.partials;var s="",o,u,a="function",f=this.escapeExpression,l=this;s+='<div class="componentContainer" style="top: ',u=n.y,u?o=u.call(t,{hash:{}}):(o=t.y,o=typeof o===a?o():o),s+=f(o)+"px; left: ",u=n.x,u?o=u.call(t,{hash:{}}):(o=t.x,o=typeof o===a?o():o),s+=f(o)+"px; width: ",o=t.scale,o=o==null||o===!1?o:o.width,o=typeof o===a?o():o,s+=f(o)+"px; height: ",o=t.scale,o=o==null||o===!1?o:o.height,o=typeof o===a?o():o,s+=f(o)+'px;">',o=t,o=l.invokePartial(r.TransformContainer,"TransformContainer",o,n,r);if(o||o===0)s+=o;return s}),SVGImage:e.template(function(e,t,n,r,i){n=n||e.helpers,r=r||e.partials;var s="",o,u,a=this,f="function",l=this.escapeExpression;o=t,o=a.invokePartial(r.SVGContainer,"SVGContainer",o,n,r);if(o||o===0)s+=o;return s+='<img src="',u=n.src,u?o=u.call(t,{hash:{}}):(o=t.src,o=typeof o===f?o():o),s+=l(o)+'" style="width: 100%; height: 100%"></img></div></div>',s}),TextBox:e.template(function(e,t,n,r,i){n=n||e.helpers,r=r||e.partials;var s="",o,u,a=this,f="function",l=this.escapeExpression;o=t,o=a.invokePartial(r.ComponentContainer,"ComponentContainer",o,n,r);if(o||o===0)s+=o;return s+='<div style="font-family: ',u=n.family,u?o=u.call(t,{hash:{}}):(o=t.family,o=typeof o===f?o():o),s+=l(o)+"; font-size: ",u=n.size,u?o=u.call(t,{hash:{}}):(o=t.size,o=typeof o===f?o():o),s+=l(o)+"px;			font-weight: ",u=n.weight,u?o=u.call(t,{hash:{}}):(o=t.weight,o=typeof o===f?o():o),s+=l(o)+"; font-style: ",u=n.style,u?o=u.call(t,{hash:{}}):(o=t.style,o=typeof o===f?o():o),s+=l(o)+"; color: #",u=n.color,u?o=u.call(t,{hash:{}}):(o=t.color,o=typeof o===f?o():o),s+=l(o)+";			text-decoration: ",u=n.decoration,u?o=u.call(t,{hash:{}}):(o=t.decoration,o=typeof o===f?o():o),s+=l(o)+"; text-align: ",u=n.align,u?o=u.call(t,{hash:{}}):(o=t.align,o=typeof o===f?o():o),s+=l(o)+'">',u=n.text,u?o=u.call(t,{hash:{}}):(o=t.text,o=typeof o===f?o():o),s+=l(o)+"</div></div></div>",s}),TransformContainer:e.template(function(e,t,n,r,i){function l(e,t){var r="",i,s;return r+="rotate(",s=n.rotate,s?i=s.call(e,{hash:{}}):(i=e.rotate,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function c(e,t){var r="",i,s;return r+="skewX(",s=n.skewX,s?i=s.call(e,{hash:{}}):(i=e.skewX,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function h(e,t){var r="",i,s;return r+="skewY(",s=n.skewY,s?i=s.call(e,{hash:{}}):(i=e.skewY,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function p(e,t){var r="",i,s;return r+="rotate(",s=n.rotate,s?i=s.call(e,{hash:{}}):(i=e.rotate,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function d(e,t){var r="",i,s;return r+="skewX(",s=n.skewX,s?i=s.call(e,{hash:{}}):(i=e.skewX,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function v(e,t){var r="",i,s;return r+="skewY(",s=n.skewY,s?i=s.call(e,{hash:{}}):(i=e.skewY,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function m(e,t){var r="",i,s;return r+="rotate(",s=n.rotate,s?i=s.call(e,{hash:{}}):(i=e.rotate,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function g(e,t){var r="",i,s;return r+="skewX(",s=n.skewX,s?i=s.call(e,{hash:{}}):(i=e.skewX,i=typeof i===u?i():i),r+=a(i)+"rad)",r}function y(e,t){var r="",i,s;return r+="skewY(",s=n.skewY,s?i=s.call(e,{hash:{}}):(i=e.skewY,i=typeof i===u?i():i),r+=a(i)+"rad)",r}n=n||e.helpers;var s="",o,u="function",a=this.escapeExpression,f=this;s+='<div class="transformContainer" style="-webkit-transform: ',o=t.rotate,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(1,l,i)});if(o||o===0)s+=o;s+=" ",o=t.skewX,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(3,c,i)});if(o||o===0)s+=o;s+=" ",o=t.skewY,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(5,h,i)});if(o||o===0)s+=o;s+="; -moz-transform: ",o=t.rotate,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(7,p,i)});if(o||o===0)s+=o;s+=" ",o=t.skewX,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(9,d,i)});if(o||o===0)s+=o;s+=" ",o=t.skewY,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(11,v,i)});if(o||o===0)s+=o;s+="; transform: ",o=t.rotate,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(13,m,i)});if(o||o===0)s+=o;s+=" ",o=t.skewX,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(15,g,i)});if(o||o===0)s+=o;s+=" ",o=t.skewY,o=n["if"].call(t,o,{hash:{},inverse:f.noop,fn:f.program(17,y,i)});if(o||o===0)s+=o;return s+='">',s}),Video:e.template(function(e,t,n,r,i){n=n||e.helpers,r=r||e.partials;var s="",o,u,a=this,f="function",l=this.escapeExpression;o=t,o=a.invokePartial(r.ComponentContainer,"ComponentContainer",o,n,r);if(o||o===0)s+=o;return s+='<video controls>	<source src="',u=n.src,u?o=u.call(t,{hash:{}}):(o=t.src,o=typeof o===f?o():o),s+=l(o)+'" type="',u=n.videoType,u?o=u.call(t,{hash:{}}):(o=t.videoType,o=typeof o===f?o():o),s+=l(o)+'"></source></video></div></div>',s})}}),define("ui/impress_renderer/ImpressRenderer",["vendor/amd/Handlebars","./Templates","common/Math2"],function(e,t,n){var r;return r=function(){function r(){var r=this;e.registerHelper("renderComponent",function(n){var i;i="";switch(n.get("type")){case"ImageModel":n.get("imageType")==="SVG"?i=t.SVGImage(n.attributes):i=t.Image(n.attributes);break;case"TextBox":i=t.TextBox(r.convertTextBoxData(n.attributes));break;case"Video":i=t.Video(n.attributes)}return new e.SafeString(i)}),e.registerHelper("scaleX",function(e){return e*slideConfig.size.width/150}),e.registerHelper("scaleY",function(e){return e*slideConfig.size.width/150}),e.registerHelper("toDeg",function(e){return e*180/Math.PI}),e.registerHelper("negate",function(e){return-1*e}),e.registerHelper("round",function(e){return n.round(e,2)}),e.registerHelper("extractBG",function(e){var t,n,r,i,s,o;if(e!=null&&e.length>0){r="",i=e[0],t=["-moz-","-webkit-","-o-","-ms-",""];for(s=0,o=t.length;s<o;s++)n=t[s],r+="background-image: "+n+i+"; ";return r}return""}),e.registerPartial("ComponentContainer",t.ComponentContainer),e.registerPartial("TransformContainer",t.TransformContainer),e.registerPartial("SVGContainer",t.SVGContainer)}return r.prototype.render=function(e){var n,r,i,s,o=this;return s=e.slides,r=6,n=0,s.each(function(e){var t;return t=e.get("x"),t==null&&(e.set("x",n*160+30),e.set("y",(n/r|0)*160+80)),++n}),i=t.ImpressTemplate(e),i},r.prototype.convertTextBoxData=function(t){var n;return n=_.extend({},t),n.text=new e.SafeString(t.text),n},r}(),new r}),define("ui/widgets/RawTextImporter",["vendor/amd/backbone","./Templates"],function(e,t){return e.View.extend({className:"rawTextImporter modal",events:{"click .ok":"okClicked",hidden:"hidden"},initialize:function(){},show:function(e,t){return this.cb=e,t!=null&&this.$txtArea.val(t),this.$el.modal("show")},makeDownloadable:function(){var e,t,n;return e="application/json",n=new Blob([this.$txtArea.val()],{type:e}),t=$('<a class="downloadLink btn btn-inverse" target="_blank" title="Download"><i class="icon-download-alt icon-white"></i></a>')[0],t.download="presentation.json",t.href=window.URL.createObjectURL(n),t.dataset.downloadurl=[e,t.download,t.href].join(":"),this.$el.find(".modal-footer").prepend(t)},okClicked:function(){return this.cb!=null&&this.cb(this.$txtArea.val()),this.$el.modal("hide")},hidden:function(){return this.$txtArea!=null&&this.$txtArea.val(""),this._cleanUpDownloadLink()},_cleanUpDownloadLink:function(){var e;e=this.$el.find(".downloadLink");if(e.length!==0)return console.log("Removing prev link"),window.URL.revokeObjectURL(e.attr("href")),e.remove()},render:function(){return this.$el.html(t.RawTextImporter()),this.$el.modal(),this.$el.modal("hide"),this.$txtArea=this.$el.find("textarea"),this.$el}})}),define("storage/FileStorage",[],function(){var e,t;return t="Strut_",e=function(){function e(){this.storageImpl=localStorage}return e.prototype.fileNames=function(){var e,n,r,i;i=this.storageImpl.length,r=0,n=[];while(r<i)e=localStorage.key(r),e.indexOf(t)!==-1&&n.push(e.replace(t,"")),++r;return n},e.prototype.remove=function(e){return this.storageImpl.removeItem(t+e)},e.prototype.save=function(e,n){return this.storageImpl.setItem(t+e,JSON.stringify(n))},e.prototype.open=function(e){var n;n=this.storageImpl.getItem(t+e);if(n==null)return null;try{return JSON.parse(n)}catch(r){return null}},e}(),new e}),define("ui/widgets/OpenDialog",["vendor/amd/backbone","./Templates","storage/FileStorage","css!./res/css/OpenDialog.css"],function(e,t,n,r){return e.View.extend({className:"openDialog modal",events:function(){return{"click .ok":"okClicked","click li > a > span":"fileClicked","click li > a > button":"deleteClicked"}},initialize:function(){},show:function(e,t){return this._renderPartial(),this.cb=e,this.$el.modal("show")},okClicked:function(){return this.cb!=null&&this.cb(this.$el.find(".active span").text()),this.$el.modal("hide")},fileClicked:function(e){return this.$el.find(".active").removeClass("active"),$(e.currentTarget).parent().parent().addClass("active")},deleteClicked:function(e){var t,r;return t=$(e.currentTarget),r=t.siblings("span").text(),n.remove(r),t.parent().parent().remove()},_renderPartial:function(){return this.$el.html(this.__template()({fileNames:n.fileNames()}))},__template:function(){return t.OpenDialog},render:function(){return this._renderPartial(),this.$el.modal(),this.$el.modal("hide"),this.$el}})}),define("ui/widgets/SaveAsDialog",["vendor/amd/backbone","./Templates","./OpenDialog"],function(e,t,n){return n.extend({initialize:function(){return n.prototype.initialize.apply(this,arguments)},fileClicked:function(e){return n.prototype.fileClicked.call(this,e),this.$nameInput.val($(e.currentTarget).text())},okClicked:function(){return console.log(this.$nameInput.val()),this.cb!=null&&this.cb(this.$nameInput.val()),this.$el.modal("hide")},__template:function(){return t.SaveAsDialog},_renderPartial:function(){return n.prototype._renderPartial.call(this),this.$nameInput=this.$el.find("input")},render:function(){return this._renderPartial(),this.$el.modal(),this.$el.modal("hide"),this.$el}})}),define("ui/widgets/BackgroundPicker",["vendor/amd/backbone","./Templates","css!./res/css/BackgroundPicker.css"],function(e,t,n){var r;return r={type:function(e){return this._updatePicker({type:e})},direction:function(e){return this._updatePicker({fillDirection:e})}},e.View.extend({className:"backgroundPicker modal",events:{"click .ok":"okClicked","click [data-option]":"optionChosen"},initialize:function(){},show:function(e,t){return this.$el.modal("show"),t!=null&&this._updatePicker(t),this.cb=e},_updatePicker:function(e){return this.$gradientPicker.gradientPicker("update",e)},_updateGradientPreview:function(e){return this.$gradientPreview.css("background-image",e[0]),this.$gradientPreview.css("background-image",e[1])},okClicked:function(){return this.$el.modal("hide"),this.cb(this.$gradientPicker.gradientPicker("currentState"))},optionChosen:function(e){var t,n;return t=e.currentTarget.dataset.option,n=e.target.dataset.value,r[t].call(this,n)},render:function(){var e,n=this;return this.$el.html(t.BackgroundPicker()),this.$el.modal(),this.$gradientPicker=this.$el.find(".gradientPicker"),this.$gradientPreview=this.$el.find(".gradientPreview"),this.$gradientPicker.css("width",250),e=this.options.bgOpts||{},e.change=function(e,t){return n._updateGradientPreview(t)},this.$gradientPicker.gradientPicker(e),this.$el.modal("hide"),this.$el.find(".dropdown-toggle").dropdown(),this.$el}})}),define("model/common_application/AutoSaver",["storage/FileStorage"],function(e){var t,n;return n={interval:10,onUnload:!0},t=function(){function t(e,t){var r=this;this.model=e,this.options=t,this.options||(this.options={}),_.defaults(this.options,n),this.options.onUnload&&$(window).unload(function(){return r._save()})}return t.prototype.start=function(){var e=this;if(this.handle==null)return this.handle=setInterval(function(){return e._save()},this.options.interval*1e3)},t.prototype.stop=function(){if(this.handle!=null)return clearInterval(this.handle),this.handle=null},t.prototype._save=function(){var t;return t=this.model.get("fileName"),t==null&&(t="presentation-1",this.model.set("fileName",t)),t!==this._lastName&&(this._lastName=t,localStorage.setItem("StrutLastPres",t)),e.save(t,this.model.toJSON(!1,!0))},t}()}),define("vendor/amd/jszip",[],function(){var e=function(e,t){this.files={},this.root="",e&&this.load(e,t)};e.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},e.defaults={base64:!1,binary:!1,dir:!1,date:null},e.prototype=function(){var n=function(e,t,n){this.name=e,this.data=t,this.options=n};n.prototype={asText:function(){return this.options.binary?e.prototype.utf8decode(this.data):this.data},asBinary:function(){return this.options.binary?this.data:e.prototype.utf8encode(this.data)}};var r=function(e,t){var n="",r;for(r=0;r<t;r++)n+=String.fromCharCode(e&255),e>>>=8;return n},i=function(){var e={},t,n;for(t=0;t<arguments.length;t++)for(n in arguments[t])typeof e[n]=="undefined"&&(e[n]=arguments[t][n]);return e},s=function(t){return t=t||{},t.base64===!0&&t.binary==null&&(t.binary=!0),t=i(t,e.defaults),t.date=t.date||new Date,t},o=function(e,t,n){var r=u(e);return r&&a.call(this,r),n=s(n),this.files[e]={name:e,data:t,options:n}},u=function(e){e.slice(-1)=="/"&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},a=function(e){e.slice(-1)!="/"&&(e+="/");if(!this.files[e]){var t=u(e);t&&a.call(this,t),o.call(this,e,"",{dir:!0})}return this.files[e]},f=function(n,i,s){var o=i!==n.name,u=n.data,a=n.options,f,l;f=a.date.getHours(),f<<=6,f|=a.date.getMinutes(),f<<=5,f|=a.date.getSeconds()/2,l=a.date.getFullYear()-1980,l<<=4,l|=a.date.getMonth()+1,l<<=5,l|=a.date.getDate(),a.base64===!0&&(u=t.decode(u)),a.binary===!1&&(u=this.utf8encode(u));var c=e.compressions[s],h=c.compress(u),p="";return p+="\n\0",p+=o?"\0\b":"\0\0",p+=c.magic,p+=r(f,2),p+=r(l,2),p+=r(this.crc32(u),4),p+=r(h.length,4),p+=r(u.length,4),p+=r(i.length,2),p+="\0\0",{header:p,compressedData:h}};return{load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t=[],r,s,o,u;for(r in this.files)o=this.files[r],u=new n(o.name,o.data,i(o.options)),s=r.slice(this.root.length,r.length),r.slice(0,this.root.length)===this.root&&e(s,u)&&t.push(u);return t},file:function(e,t,n){if(arguments.length===1){if(e instanceof RegExp){var r=e;return this.filter(function(e,t){return!t.options.dir&&r.test(e)})}return this.filter(function(t,n){return!n.options.dir&&t===e})[0]||null}return e=this.root+e,o.call(this,e,t,n),this},folder:function(e){if(!e)throw new Error("folder : wrong argument");if(e instanceof RegExp)return this.filter(function(t,n){return n.options.dir&&e.test(t)});var t=this.root+e,n=a.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];t||(e.slice(-1)!="/"&&(e+="/"),t=this.files[e]);if(t)if(!t.options.dir)delete this.files[e];else{var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e});for(var r=0;r<n.length;r++)delete this.files[n[r].name]}return this},generate:function(n){n=i(n||{},{base64:!0,compression:"STORE"});var s=n.compression.toUpperCase(),o=[],u=[],a=0;if(!e.compressions[s])throw s+" is not a valid compression method !";for(var l in this.files){if(!this.files.hasOwnProperty(l))continue;var c=this.files[l],h=this.utf8encode(c.name),p="",d="",v=f.call(this,c,h,s);p=e.signature.LOCAL_FILE_HEADER+v.header+h+v.compressedData,d=e.signature.CENTRAL_FILE_HEADER+"\0"+v.header+"\0\0"+"\0\0"+"\0\0"+(this.files[l].dir===!0?"\0\0\0":"\0\0\0\0")+r(a,4)+h,a+=p.length,u.push(p),o.push(d)}var m=u.join(""),g=o.join(""),y="";y=e.signature.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+r(u.length,2)+r(u.length,2)+r(g.length,4)+r(m.length,4)+"\0\0";var b=m+g+y;return n.base64?t.encode(b):b},crc32:function(e,t){if(e===""||typeof e=="undefined")return 0;var n="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";typeof t=="undefined"&&(t=0);var r=0,i=0;t^=-1;for(var s=0,o=e.length;s<o;s++)i=(t^e.charCodeAt(s))&255,r="0x"+n.substr(i*9,8),t=t>>>8^r;return t^-1},clone:function(){var t=new e;for(var n in this)typeof this[n]!="function"&&(t[n]=this[n]);return t},utf8encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},utf8decode:function(e){var t="",n=0,r=0,i=0,s=0,o=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(s=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|s&63),n+=2):(s=e.charCodeAt(n+1),o=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63),n+=3);return t}}}(),e.compressions={STORE:{magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e}}};var t=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t,n){var r="",i,s,o,u,a,f,l,c=0;while(c<t.length)i=t.charCodeAt(c++),s=t.charCodeAt(c++),o=t.charCodeAt(c++),u=i>>2,a=(i&3)<<4|s>>4,f=(s&15)<<2|o>>6,l=o&63,isNaN(s)?f=l=64:isNaN(o)&&(l=64),r=r+e.charAt(u)+e.charAt(a)+e.charAt(f)+e.charAt(l);return r},decode:function(t,n){var r="",i,s,o,u,a,f,l,c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<t.length)u=e.indexOf(t.charAt(c++)),a=e.indexOf(t.charAt(c++)),f=e.indexOf(t.charAt(c++)),l=e.indexOf(t.charAt(c++)),i=u<<2|a>>4,s=(a&15)<<4|f>>2,o=(f&3)<<6|l,r+=String.fromCharCode(i),f!=64&&(r+=String.fromCharCode(s)),l!=64&&(r+=String.fromCharCode(o));return r}}}();return e}),define("model/presentation/SlideCollection",["common/Calcium","./Slide"],function(e,t){var n;return n=function(e,t){return e.get("num")-t.get("num")},e.Collection.extend({model:t,initialize:function(){return this.on("add",this._updateNumbers,this),this.on("remove",this._updateNumbers,this)},_updateNumbers:function(){return this.models.forEach(function(e,t){return e.set("num",t)})},sort:function(e){var t,r=this;return e||(e={}),t={},this.models.forEach(function(e,n){var i;i=e.get("num");if(i!==n&&!t[i])return t[i]=!0,t[n]=!0,r._swapTransitionPositions(e,r.models[i])}),this.models.sort(n)},_swapTransitionPositions:function(e,t){var n,r;return r=e.getPositionData(),n={silent:!0},e.set(t.getPositionData(),n),t.set(r,n)}})}),define("common/collections/LinkedList",[],function(){var e;return e=function(){function e(){this.head=this.tail=null,this.length=0}return e.prototype.push=function(e){var t;return t={prev:null,next:null,value:e},this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):this.head=this.tail=t,++this.length,this},e.prototype.pop=function(){var e;if(this.tail==null)throw"List is empty";return e=this.tail.value,this.tail===this.head?this.tail=this.head=null:(this.tail=this.tail.prev,this.tail.next=null),--this.length,e},e.prototype.shift=function(){var e;if(this.head==null)throw"List is empty";return e=this.head.value,this.tail===this.head?this.tail=this.head=null:(this.head=this.head.next,this.head.prev=null),--this.length,e},e.prototype.unshift=function(e){var t;return t={prev:null,next:null,value:e},this.head!=null?(this.head.prev=t,t.next=this.head,this.head=t):this.head=this.tail=t,++this.length,this},e.prototype.first=function(){return this.head.value},e.prototype.last=function(){return this.tail.value},e.prototype.forEach=function(e){var t,n,r;t=this.head,n=0,r=[];while(t!==null)e(t.value,n++,this),r.push(t=t.next);return r},e}()}),define("model/common_application/UndoHistory",["common/EventEmitter","common/collections/LinkedList"],function(e,t){var n;return n=function(){function n(n){this.size=n,this.actions=new t,this.cursor=null,this.undoCount=0,_.extend(this,new e)}return n.prototype.clear=function(){return this.cursor=null,this.undoCount=null,this.actions=new t},n.prototype.push=function(e){var t;return this.actions.length-this.undoCount<this.size?this.undoCount>0?(t={prev:null,next:null,value:e},this.cursor?(t.prev=this.cursor,this.cursor.next.prev=null,this.cursor.next=t,this.actions.length+=1,this.actions.length=this.actions.length-this.undoCount):(this.actions.head=t,this.actions.length=1),this.actions.tail=t,this.undoCount=0,this.cursor=null):(this.actions.push(e),this.cursor=null):(this.actions.shift(),this.actions.push(e)),this.emit("updated"),this},n.prototype.pushdo=function(e){return e["do"](),this.push(e)},n.prototype.undoName=function(){var e;return this.undoCount<this.actions.length?(e=this.cursor||this.actions.tail,e!=null?e.value.name:""):""},n.prototype.redoName=function(){var e;return this.undoCount>0?(this.cursor==null?e=this.actions.head:e=this.cursor.next,e!=null?e.value.name:""):""},n.prototype.undo=function(){return this.undoCount<this.actions.length&&(this.cursor==null&&(this.cursor=this.actions.tail),this.cursor.value.undo(),this.cursor=this.cursor.prev,++this.undoCount,this.emit("updated")),this},n.prototype.redo=function(){return this.undoCount>0&&(this.cursor==null?this.cursor=this.actions.head:this.cursor=this.cursor.next,this.cursor.value["do"](),--this.undoCount,this.emit("updated")),this},n}()}),define("model/presentation/Deck",["common/Calcium","./SlideCollection","./Slide","model/commands/SlideCommands","model/common_application/UndoHistory"],function(e,t,n,r,i){return e.Model.extend({initialize:function(){var e;return window.undoHistory=new i(20),this.undoHistory=window.undoHistory,this.set("slides",new t),e=this.get("slides"),e.on("add",this._slideAdded,this),e.on("remove",this._slideRemoved,this),e.on("reset",this._slidesReset,this),this._lastSelected=null},newSlide:function(){var e,t;return e=new r.Create(this),t=e["do"](),this.undoHistory.push(e),t},set:function(t,n){return t==="activeSlide"&&this._activeSlideChanging(n),e.Model.prototype.set.apply(this,arguments)},"import":function(e){var t,n;return n=this.get("slides"),t=this.get("activeSlide"),t!=null&&t.unselectComponents(),this.set("activeSlide",null),this.set("background",e.background),this.set("fileName",e.fileName),this.undoHistory.clear(),n.reset(e.slides)},_activeSlideChanging:function(e){var t;t=this.get("activeSlide");if(e===t)return null;t!=null&&(t.unselectComponents(),t.set({active:!1,selected:!1}));if(e!=null)return e.set({selected:!0,active:!0})},_slideAdded:function(e,t){return this.set("activeSlide",e),this._registerWithSlide(e)},_slideDisposed:function(e){return e.off(null,null,this)},_slideRemoved:function(e,t,n){return console.log("Slide removed"),this.get("activeSlide")===e&&(n.index<t.length?this.set("activeSlide",t.at(n.index)):n.index>0?this.set("activeSlide",t.at(n.index-1)):this.set("activeSlide",null)),e.dispose()},_slidesReset:function(e,t,n){var r=this;return n.forEach(function(e){return e.dispose()}),e.forEach(function(e){r._registerWithSlide(e);if(e.get("active"))return e.trigger("change:active",e,!0);if(e.get("selected"))return e.set("selected",!1)})},_slideActivated:function(e,t){if(t)return this.set("activeSlide",e)},_slideSelected:function(e,t){return this._lastSelected!=null&&t&&this._lastSelected!==e&&this._lastSelected.set("selected",!1),this._lastSelected=e},_registerWithSlide:function(e){return e.on("change:active",this._slideActivated,this),e.on("change:selected",this._slideSelected,this),e.on("dispose",this._slideDisposed,this)},removeSlide:function(e){return this.undoHistory.pushdo(new r.Remove(this,e)),e},addSlide:function(e){return this.get("slides").add(e)},undo:function(){return this.undoHistory.undo()},redo:function(){return this.undoHistory.redo()}})}),define("model/presentation/Archiver",["vendor/amd/jszip","./Deck","ui/impress_renderer/ImpressRenderer","common/FileUtils"],function(e,t,n,r){var i,s;return s={includeImages:!0,includeFonts:!0},i=function(){function i(e,t){this.presentation=e,this.options=t,this.options||(this.options={}),this.canvas=$("<canvas></canvas>")[0],this._archivedImages={},this._imageIdx=0,_.defaults(this.options,s)}return i.prototype.create=function(){var r,i,s=this;return this.archive=new e,this.previewExportDir=this.archive.folder("preview_export"),this.imagesDir=this.previewExportDir.folder("images"),this.scriptsDir=this.previewExportDir.folder("scripts"),this.fontsDir=this.previewExportDir.folder("fonts"),this.cssDir=this.previewExportDir.folder("css"),r=new t,r["import"](this.presentation.toJSON(!1,!0)),r.get("slides").each(function(e){return s.processComponents(e.get("components"))}),i="<!doctype html><html>"+n.render(r.attributes)+"</html>",this._archiveIndexHtml(i),this._archiveScripts(),this._archiveFonts(),this._archiveCss(),this._archivedImages={},this.archive.generate()},i.prototype.createSimple=function(t){var r,i=this;return this.archive=new e,this.previewExportDir=this.archive.folder("preview_export"),this.scriptsDir=this.previewExportDir.folder("scripts"),this.cssDir=this.previewExportDir.folder("css"),r="<!doctype html><html>"+n.render(this.presentation.attributes)+"</html>",this._archiveIndexHtml(r),this._archiveScripts(function(){return i._archiveCss(function(){return t(i.archive.generate())})})},i.prototype.processComponents=function(e){var t=this;return e.forEach(function(e){return t.processComponent(e)})},i.prototype.processComponent=function(e){if(e.get("type")==="ImageModel"&&this.options.includeImages)return this._archiveImage(e)},i.prototype._archiveIndexHtml=function(e){return this.archive.file("index.html",e)},i.prototype._archiveScripts=function(e){var t=this;return requirejs(["text!../preview_export/scripts/impress.js"],function(n){return t.scriptsDir.file("impress.js",n),e()})},i.prototype._archiveFonts=function(){},i.prototype._archiveCss=function(e){var t=this;return requirejs(["text!../zip/main.css"],function(n){return t.cssDir.file("main.css",n),e()})},i.prototype._archiveImage=function(e){var t,n;if(!this._archivedImages[e.get("src")])return this._archivedImages[e.get("src")]=!0,n=e.cachedImage,this.canvas.width=n.naturalWidth,this.canvas.height=n.naturalHeight,this.canvas.getContext("2d").drawImage(n,0,0),t=this._imageIdx+r.baseName(e.get("src")),this.imagesDir.file(t,this.canvas.toDataURL().replace(/^data:image\/(png|jpg);base64,/,""),{base64:!0}),e.set("src","preview_export/images/"+t)},i}()}),define("ui/editor/Editor",["vendor/amd/backbone","./SlideEditor","./transition_editor/TransitionEditor","./Templates","ui/impress_renderer/ImpressRenderer","ui/widgets/RawTextImporter","ui/widgets/OpenDialog","ui/widgets/SaveAsDialog","storage/FileStorage","ui/widgets/BackgroundPicker","model/common_application/AutoSaver","model/presentation/Archiver","css!./res/css/Editor.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p,d;return p=0,d={"new":function(e){var t;return t=localStorage.getItem("StrutNewNum"),t==null?t=2:t=parseInt(t),localStorage.setItem("StrutNewNum",t+1),this.model["import"]({fileName:"presentation-"+t,slides:[]}),this.model.newSlide()},open:function(e){var t=this;return this.openDialog.show(function(e){var n;console.log("Attempting to open "+e),n=a.open(e);if(n!=null)return t.model["import"](n),localStorage.setItem("StrutLastPres",e)})},openRecent:function(e){},save:function(e){var t;return t=this.model.get("fileName"),t==null?d.saveAs.call(this,e):a.save(t,this.model.toJSON(!1,!0))},saveAs:function(e){var t=this;return this.saveAsDialog.show(function(e){if(e!=null&&e!=="")return console.log("Attempting to save "+e),t.model.set("fileName",e),a.save(e,t.model.toJSON(!1,!0))})},undo:function(e){return this.model.undo()},redo:function(e){return this.model.redo()},cut:function(e){var t;t=this.perspectives[this.activePerspective];if(t!=null)return t.cut()},copy:function(e){var t;t=this.perspectives[this.activePerspective];if(t!=null)return t.copy()},paste:function(e){var t;t=this.perspectives[this.activePerspective];if(t!=null)return t.paste()},transitionEditor:function(e){return this.changePerspective(e,{perspective:"transitionEditor"})},slideEditor:function(e){return this.changePerspective(e,{perspective:"slideEditor"})},preview:function(e){return this.$el.trigger("preview")},exportJSON:function(e){return this.rawTextModal.show(null,JSON.stringify(this.model.toJSON(!1,!0))),this.rawTextModal.makeDownloadable()},importJSON:function(e){var t=this;return this.rawTextModal.show(function(e){return t.model["import"](JSON.parse(e))})},changeBackground:function(){var e=this;return this.backgroundPickerModal.show(function(t){return e.model.set("background",t)})},exportWebpage:function(){return $("#exportModal").modal("show")},exportZIP:function(e){var t,n,r=this;return n=new c(this.model),t=n.createSimple(function(e){return Downloadify.create("downloadify",{filename:"StrutPresentation.zip",data:e,dataType:"base64",swf:"res/downloadify/media/downloadify.swf",downloadImage:"res/downloadify/images/download.png",width:100,height:30,transparent:!0,append:!1}),$("#zipModal").modal("show")})}},e.View.extend({className:"editor",events:{"click .menuBar .dropdown-menu > li":"menuItemSelected",changePerspective:"changePerspective",preview:"renderPreview"},initialize:function(){return this.id=p++,this.perspectives={slideEditor:new t({model:this.model}),transitionEditor:new n({model:this.model})},this.activePerspective="slideEditor",this.model.undoHistory.on("updated",this.undoHistoryChanged,this),this.model.on("change:background",this._backgroundChanged,this),this.autoSaver=new l(this.model),this.autoSaver.start()},undoHistoryChanged:function(){var e,t,n;return n=this.model.undoHistory.undoName(),t=this.model.undoHistory.redoName(),n!==""?(e=this.$el.find(".undoName"),e.text(n),e.removeClass("disp-none")):this.$el.find(".undoName").addClass("disp-none"),t!==""?(e=this.$el.find(".redoName"),e.text(t),e.removeClass("disp-none")):this.$el.find(".redoName").addClass("disp-none")},renderPreview:function(){var e,t,n,r=this;return t=i.render(this.model.attributes),window.previewWind=window.open("index.html?preview=true"),n=window,e=function(){if(n.previewWind.startImpress==null)return setTimeout(e,200);n.previewWind.document.getElementsByTagName("html")[0].innerHTML=t;if(!n.previewWind.impressStarted)return n.previewWind.startImpress(n.previewWind.document,n.previewWind),n.previewWind.imp=n.previewWind.impress(),n.previewWind.imp.init(),n.previewWind.imp.goto(r.model.get("activeSlide").get("num"))},$(window.previewWind.document).ready(e)},changePerspective:function(e,t){var n=this;return this.activePerspective=t.perspective,_.each(this.perspectives,function(e,t){return t===n.activePerspective?e.show():e.hide()})},_backgroundChanged:function(e,t){var n,r,i,s;if(t!=null){i=this.perspectives,s=[];for(n in i)r=i[n],s.push(r.backgroundChanged(t));return s}},menuItemSelected:function(e){var t,n;return t=$(e.currentTarget),n=t.attr("data-option"),d[n].call(this,e)},stopAutoSaving:function(){return this.autoSaver.stop()},startAutoSaving:function(){return this.autoSaver.start()},render:function(){var e,t,n,i,a=this;return n=_.map(this.perspectives,function(e,t){return{perspective:t,name:e.name}}),this.$el.html(r.Editor({id:this.id,perspectives:n})),this.$el.find(".dropdown-toggle").dropdown(),e=this.$el.find(".perspectives-container"),_.each(this.perspectives,function(t,n){return e.append(t.render()),n===a.activePerspective?t.show():t.$el.addClass("disp-none")}),this.undoHistoryChanged(),this.rawTextModal=new s,this.$el.append(this.rawTextModal.render()),this.openDialog=new o,this.saveAsDialog=new u,i=function(){return a.stopAutoSaving()},this.openDialog.$el.on("show",i),this.saveAsDialog.$el.on("show",i),t=function(){return a.startAutoSaving()},this.openDialog.$el.on("hide",t),this.saveAsDialog.$el.on("hide",t),this.$el.append(this.openDialog.render()),this.$el.append(this.saveAsDialog.render()),$("#exportModal").modal(),$("#zipModal").modal(),this.backgroundPickerModal=new f({bgOpts:{type:"radial",controlPoints:["#F0F0F0 0%","#BEBEBE 100%"]}}),this.$el.append(this.backgroundPickerModal.render()),this.$el}})}),define("common/MapResolver",{resolveItem:function(e,t){var n=typeof t;if(n==="string"||n==="number")return e[t];var r=e;for(var i=0;i<t.length;++i){var s=t[i];r=r[s];if(!r)return null}return r},placeItem:function(e,t,n){var r=typeof t;if(r==="string"||r==="number")return e[t]=n;var i=e;for(var s=0;s<t.length-1;++s){var o=t[s],u=i[o];u||(u={},i[o]=u),i=u}var a=t[t.length-1];return i[a]=n}}),define("state/DefaultState",["common/MapResolver"],function(e){var t,n;return n={editor:{slideEditor:{buttonBar:{fontSize:72,fontFamily:"'Lato', sans-serif",fontColor:"grey",fontStyle:"",fontWeight:""}}}},t={get:function(t){return e.resolveItem(n,t)}}}),define("ui/etch/Templates",["vendor/amd/Handlebars"],function(e){return{align:e.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a="function",f=this.escapeExpression;return s+='<a href="#" 	class="btn btn-small etch-',u=n.button,u?o=u.call(t,{hash:{}}):(o=t.button,o=typeof o===a?o():o),s+=f(o)+'" title="',u=n.title,u?o=u.call(t,{hash:{}}):(o=t.title,o=typeof o===a?o():o),s+=f(o)+'"><i class="icon-align-',u=n.icon,u?o=u.call(t,{hash:{}}):(o=t.icon,o=typeof o===a?o():o),s+=f(o)+'"></i></a>',s}),colorChooser:e.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a="function",f=this.escapeExpression;return s+='<div class="color-chooser etch-',u=n.button,u?o=u.call(t,{hash:{}}):(o=t.button,o=typeof o===a?o():o),s+=f(o)+'"><div></div></div>',s}),defaultButton:e.template(function(e,t,n,r,i){n=n||e.helpers;var s="",o,u,a="function",f=this.escapeExpression;return s+='<a href="#" 	class="btn btn-small etch-',u=n.button,u?o=u.call(t,{hash:{}}):(o=t.button,o=typeof o===a?o():o),s+=f(o)+'" title="',u=n.title,u?o=u.call(t,{hash:{}}):(o=t.title,o=typeof o===a?o():o),s+=f(o)+'"><span>',u=n.display,u?o=u.call(t,{hash:{}}):(o=t.display,o=typeof o===a?o():o),s+=f(o)+"</span></a>",s}),fontFamilySelection:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="btn-group">	<button class="btn btn-inverse dropdown-toggle btn-small fontFamilyBtn" data-toggle="dropdown" title="Choose the font family"><span class="text">Lato</span><span class="caret"></span></button>	<ul class="dropdown-menu menuBarOption" data-option="fontFamily">		<li>                  <a class="lato" href="#" data-value="\'Lato\', sans-serif">Lato</a>                  <a class="ubuntu" href="#" data-value="\'Ubuntu\', sans-serif">Ubuntu</a>                  <a class="abril" href="#" data-value="\'Abril Fatface\', cursive">Abril</a>                  <a class="hammersmith" href="#" data-value="\'Hammersmith One\', sans-serif">Hammersmith One</a>                  <a class="fredoka" href="#" data-value="\'Fredoka One\', cursive">Fredoka One</a>                  <a class="gorditas" href="#" data-value="\'Gorditas\', cursive">Gorditas</a>                  <a class="pressstart" href="#" data-value="\'Press Start 2P\', cursive">Press Start 2P</a>		</li>	</ul></div>'}),fontSizeSelection:e.template(function(e,t,n,r,i){return n=n||e.helpers,'<div class="btn-group">	<a class="btn btn-small btn-inverse dropdown-toggle" data-toggle="dropdown" title="Choose the font size"><span class="text">72</span>		<span class="caret"></span></a>	<ul class="dropdown-menu menuBarOption" data-option="fontSize">		<li>                  <a href="#" data-value="144">144</a>                  <a href="#" data-value="96">96</a>                  <a href="#" data-value="72">72</a>			<a href="#" data-value="64">64</a>                  <a href="#" data-value="48">48</a>                  <a href="#" data-value="36">36</a>                  <a href="#" data-value="24">24</a>                  <a href="#" data-value="16">16</a>                  <a href="#" data-value="12">12</a>                  <a href="#" data-value="8">8</a>		</li>     	</ul></div>'})}});var continuation;requirejs.config({paths:{css:"vendor/amd_plugins/css",text:"vendor/amd_plugins/text"}}),window.browserPrefix="",$.browser.mozilla?window.browserPrefix="-moz-":$.browser.msie?window.browserPrefix="-ms-":$.browser.opera?window.browserPrefix="-o-":$.browser.webkit&&(window.browserPrefix="-webkit-"),window.URL=window.webkitURL||window.URL,window.Blob=window.Blob||window.WebKitBlob||window.MozBlob,window.localStorage==null&&(window.localStorage={setItem:function(){},getItem:function(){},length:0});if(Function.bind==null||Function.prototype.bind!=null)Function.prototype.bind=function(e){var t;return t=this,function(){return t.apply(e,arguments)}};window.location.href.indexOf("preview=true")===-1&&(continuation=function(){return requirejs(["ui/editor/Editor","model/presentation/Deck","storage/FileStorage","model/common_application/UndoHistory"],function(e,t,n,r){var i,s,o,u;window.undoHistory=new r(20),i=new t,s=new e({model:i}),window.zTracker={z:0,next:function(){return++this.z}},$("body").append(s.render()),o=localStorage.getItem("StrutLastPres"),o!=null&&(u=n.open(o),u!=null&&i["import"](u));if(o==null)return i.newSlide()})},requirejs(["vendor/amd/backbone","state/DefaultState","vendor/amd/etch","ui/etch/Templates","css!ui/etch/res/css/etchOverrides.css"],function(e,t,n,r){return e.sync=function(e,n,r){if(r.keyTrail!=null)return r.success(t.get(r.keyTrail))},window.slideConfig={size:{width:1024,height:768}},_.extend(n.config.buttonClasses,{"default":["<group>","bold","italic","</group>","<group>","unordered-list","ordered-list","</group>","<group>","justify-left","justify-center","</group>","<group>","link","</group>","font-family","font-size","<group>","color","</group>"]}),n.buttonElFactory=function(e){var t;t={button:e,title:e.replace("-"," "),display:e.substring(0,1).toUpperCase()};if(e==="link"||e==="clear-formatting"||e==="ordered-list"||e==="unordered-list")t.display="";switch(e){case"font-size":return r.fontSizeSelection(t);case"font-family":return r.fontFamilySelection(t);case"color":return r.colorChooser(t);default:return e.indexOf("justify")!==-1?(t.icon=e.substring(e.indexOf("-")+1,e.length),r.align(t)):r.defaultButton(t)}},n.groupElFactory=function(){return $('<div class="btn-group">')},continuation()})),define("main",function(){})